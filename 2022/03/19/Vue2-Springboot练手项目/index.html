<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/mini-black-hole-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/mini-black-hole-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hreatehakunari.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="1. 创建项目前端： vue init webpack firstproject-web 后端： IDEA 新建项目 -&gt; Spring Initializr -&gt; Java8、Maven -&gt;Dependencies: Web -&gt;  2. 前端登录界面开发及前端的反向代理2.1 设置反向代理先安装 axios ： npm install --save axios mai">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue2+Springboot练手项目">
<meta property="og:url" content="http://hreatehakunari.com/2022/03/19/Vue2-Springboot%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE/index.html">
<meta property="og:site_name" content="Interstellar">
<meta property="og:description" content="1. 创建项目前端： vue init webpack firstproject-web 后端： IDEA 新建项目 -&gt; Spring Initializr -&gt; Java8、Maven -&gt;Dependencies: Web -&gt;  2. 前端登录界面开发及前端的反向代理2.1 设置反向代理先安装 axios ： npm install --save axios mai">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203181048309.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203190816454.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203181754029.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182222333.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182323772.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182335045.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203190816474.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182335345.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182337544.png">
<meta property="og:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203190816489.png">
<meta property="article:published_time" content="2022-03-19T00:14:16.000Z">
<meta property="article:modified_time" content="2022-03-19T00:20:15.946Z">
<meta property="article:author" content="HreateHakunari">
<meta property="article:tag" content="Vue">
<meta property="article:tag" content="Vue2">
<meta property="article:tag" content="Springboot">
<meta property="article:tag" content="项目">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203181048309.png">

<link rel="canonical" href="http://hreatehakunari.com/2022/03/19/Vue2-Springboot%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Vue2+Springboot练手项目 | Interstellar</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/rss2.xml" title="Interstellar" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Interstellar</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>resources</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://hreatehakunari.com/2022/03/19/Vue2-Springboot%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="HreateHakunari">
      <meta itemprop="description" content="Do not go gentle into that good night.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Interstellar">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Vue2+Springboot练手项目
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-03-19 08:14:16 / 修改时间：08:20:15" itemprop="dateCreated datePublished" datetime="2022-03-19T08:14:16+08:00">2022-03-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">项目</span></a>
                </span>
            </span>

          
            <span id="/2022/03/19/Vue2-Springboot%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE/" class="post-meta-item leancloud_visitors" data-flag-title="Vue2+Springboot练手项目" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/03/19/Vue2-Springboot%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/03/19/Vue2-Springboot%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1. 创建项目"></a>1. 创建项目</h2><p>前端：</p>
<p><code>vue init webpack firstproject-web</code></p>
<p>后端：</p>
<p>IDEA 新建项目 -&gt; Spring Initializr -&gt; Java8、Maven -&gt;Dependencies: Web -&gt; </p>
<h2 id="2-前端登录界面开发及前端的反向代理"><a href="#2-前端登录界面开发及前端的反向代理" class="headerlink" title="2. 前端登录界面开发及前端的反向代理"></a>2. 前端登录界面开发及前端的反向代理</h2><h3 id="2-1-设置反向代理"><a href="#2-1-设置反向代理" class="headerlink" title="2.1 设置反向代理"></a>2.1 设置反向代理</h3><p>先安装 axios ： <code>npm install --save axios</code></p>
<p><code>main.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="comment">// 设置反向代理，前端请求默认发送到 http://localhost:8443/api</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;http://localhost:8443/api&#x27;</span></span><br><span class="line"><span class="comment">// 全局注册，之后可能在其他组件中通过 axios 发送数据</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$axios</span> = axios</span><br></pre></td></tr></table></figure>

<h3 id="2-2-配置页面路由"><a href="#2-2-配置页面路由" class="headerlink" title="2.2 配置页面路由"></a>2.2 配置页面路由</h3><p>为了登录成功之后能跳转页面</p>
<p><code>router\index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="comment">// 导入刚才编写的组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AppIndex</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/home/AppIndex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/Login&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Router</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">  <span class="comment">// 下面都是固定的写法</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">Login</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/index&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;AppIndex&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">AppIndex</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-跨域支持"><a href="#2-3-跨域支持" class="headerlink" title="2.3 跨域支持"></a>2.3 跨域支持</h3><p>为了让后端能访问到前端的资源，需要在前端配置跨域支持</p>
<p><code>config\index.js</code> 修改 proxyTable：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">proxyTable</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://localhost:8443&#x27;</span>,</span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">pathRewrite</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-后端登录功能开发"><a href="#3-后端登录功能开发" class="headerlink" title="3. 后端登录功能开发"></a>3. 后端登录功能开发</h2><h3 id="3-1-创建对应的-User-类及传回API消息的-Result-类"><a href="#3-1-创建对应的-User-类及传回API消息的-Result-类" class="headerlink" title="3.1 创建对应的 User 类及传回API消息的 Result 类"></a>3.1 创建对应的 <code>User</code> 类及传回API消息的 <code>Result</code> 类</h3><ul>
<li>创建文件夹：<code>src\main\java\com\hreate\firstproject</code> 中创建 <code>pojo</code> 包（package），并新建 <code>User</code> 类</li>
</ul>
<p><code>User.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.evan.wj.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    String username;</span><br><span class="line">    String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建文件夹：在 <code>src\main\java\com\hreate\firstproject</code> 中创建 <code>result</code> 包，并创建 <code>Result</code> 类</li>
</ul>
<p><code>Result.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.evan.wj.result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">    <span class="comment">//响应码</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">(<span class="type">int</span> code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCode</span><span class="params">(<span class="type">int</span> code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于响应码是固定的，<code>code</code> 属性应该是个枚举值，这里做了点简化</p>
<h3 id="3-2-创建LoginController"><a href="#3-2-创建LoginController" class="headerlink" title="3.2 创建LoginController"></a>3.2 创建LoginController</h3><p> <code>src\main\java\com\hreate\firstproject</code> 中创建包 <code>controllers</code> ，并创建 <code>LoginController</code> 类</p>
<p><code>LoginCotroller.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.evan.wj.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.evan.wj.result.Result;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.util.HtmlUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.evan.wj.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;api/login&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> User requestUser)</span> &#123;</span><br><span class="line">    <span class="comment">// 对 html 标签进行转义，防止 XSS 攻击</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> requestUser.getUsername();</span><br><span class="line">        username = HtmlUtils.htmlEscape(username);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!Objects.equals(<span class="string">&quot;admin&quot;</span>, username) || !Objects.equals(<span class="string">&quot;123456&quot;</span>, requestUser.getPassword())) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;账号密码错误&quot;</span>;</span><br><span class="line">            System.out.println(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">400</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-修改后端程序执行端口：8443"><a href="#3-3-修改后端程序执行端口：8443" class="headerlink" title="3.3 修改后端程序执行端口：8443"></a>3.3 修改后端程序执行端口：8443</h3><p>进入文件： <code>src\main\resources\application.properties</code> ，加上：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span> = <span class="string">8443</span></span><br></pre></td></tr></table></figure>

<h2 id="4-引入数据库"><a href="#4-引入数据库" class="headerlink" title="4. 引入数据库"></a>4. 引入数据库</h2><h3 id="4-1-使用数据库验证登录"><a href="#4-1-使用数据库验证登录" class="headerlink" title="4.1 使用数据库验证登录"></a>4.1 使用数据库验证登录</h3><h4 id="4-1-1-项目相关配置"><a href="#4-1-1-项目相关配置" class="headerlink" title="4.1.1 项目相关配置"></a>4.1.1 项目相关配置</h4><ul>
<li>配置后端的 <code>pom.xml</code>，配置需要的所有依赖项。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.hreate<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>firstproject<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>firstproject<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>firstproject<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- springboot web --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- springboot tomcat 支持 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 热部署 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- jpa--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- redis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- springboot test --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- thymeleaf --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- elastic search --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 用了 elasticsearch 就要加这么一个，不然要com.sun.jna.Native 错误 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jna<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jna<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- thymeleaf legacyhtml5 模式支持 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sourceforge.nekohtml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nekohtml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 测试支持 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.5.23<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- junit --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span> 4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- commons-lang --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- shiro --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- hsqldb --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hsqldb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hsqldb<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>随后刷新 Maven，自动下载依赖项</p>
<ul>
<li>配置数据库：<code>src\main\resources\application.properties</code>，添加代码：</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/firstproject?characterEncoding=UTF-8</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">takanash1r1kka</span></span><br><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.jpa.hibernate.ddl-auto</span>=<span class="string">none</span></span><br></pre></td></tr></table></figure>

<h4 id="4-1-2-登录控制器"><a href="#4-1-2-登录控制器" class="headerlink" title="4.1.2 登录控制器"></a>4.1.2 登录控制器</h4><h5 id="完善-User-类"><a href="#完善-User-类" class="headerlink" title="完善 User 类"></a>完善 <code>User</code> 类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;user&quot;)</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties(&#123;&quot;handler&quot;,&quot;hibernateLazyInitializer&quot;&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;UserId&quot;)</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line"></span><br><span class="line">    String username;</span><br><span class="line">    String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主要添加了 id 的一些注解</p>
<blockquote>
<p>@Entity 表示是一个实体类</p>
<p>@Table(name&#x3D;”user”) 表示对应表名为 user</p>
</blockquote>
<p>为了简化对数据库的操作，这里使用了 Java Persistence API （JPA），对于 @JsonIgnoreProperties({“handler”, “hivernateLazyInitializer”})：</p>
<blockquote>
<p>因为是做前后端分离，而前后端数据交互用的是 json 格式。 那么 User 对象就会被转换为 json 数据。 而本项目使用 jpa 来做实体类的持久化，jpa 默认会使用 hibernate, 在 jpa 工作过程中，就会创造代理类来继承 User ，并添加 handler 和 hibernateLazyInitializer 这两个无须 json 化的属性，所以这里需要用 JsonIgnoreProperties 把这两个属性忽略掉。</p>
</blockquote>
<h5 id="UserDAO"><a href="#UserDAO" class="headerlink" title="UserDAO"></a>UserDAO</h5><blockquote>
<p>Data Access Object （数据访问对象， DAO），即用来操作数据库的对象，这个对象可以是我们自己开发的，也可以是框架提供的。这里通过继承 <code>JpaRepository</code> 的方式构建 DAO。</p>
</blockquote>
<p>新建一个 package ，命名为 <code>dao</code> ，然后创建 Java Class ，命名为 <code>UserDAO</code> ，选择种类为 Interface：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDAO</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;User,Integer&gt; &#123;</span><br><span class="line">    User <span class="title function_">findByUsername</span><span class="params">(String username)</span>;</span><br><span class="line"></span><br><span class="line">    User <span class="title function_">getByUsernameAndPassword</span><span class="params">(String username,String password)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此处关键的地方在于，由于使用了 JPA ，无需手动构建 SQL 语句，而只需要按照规范提供方法的名字即可实现对数据库的增删改查。</p>
<p>如： <code>findByUsername</code> ，就是通过 <code>username</code> 字段查询到对应的行，并返回给 User 类。</p>
<h5 id="UserService"><a href="#UserService" class="headerlink" title="UserService"></a>UserService</h5><p>新建一个 package ，命名为 <code>service</code> ，新建类 <code>UserService</code> ：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserDAO userDAO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isExist</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> getByName(username);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>!=user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getByName</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userDAO.findByUsername(username);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">get</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userDAO.getByUsernameAndPassword(username, password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        userDAO.save(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里对 <code>UserDAO</code> 进行了二次封装，一般在 DAO 中只定义基础的增删改查操作，其他具体操作需要由 Service 来完成。</p>
<h5 id="LoginController"><a href="#LoginController" class="headerlink" title="LoginController"></a>LoginController</h5><p>在之前的基础上更改判断条件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">UserService userService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@PostMapping(value = &quot;/api/login&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> User requestUser)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> requestUser.getUsername();</span><br><span class="line">    username = HtmlUtils.htmlEscape(username);</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.get(username, requestUser.getPassword());</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> == user) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">400</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-使用-Element-ui"><a href="#5-使用-Element-ui" class="headerlink" title="5. 使用 Element-ui"></a>5. 使用 Element-ui</h2><h3 id="5-1-安装"><a href="#5-1-安装" class="headerlink" title="5.1 安装"></a>5.1 安装</h3><p><code>npm i element-ui -S</code></p>
<h3 id="5-2-引入Element"><a href="#5-2-引入Element" class="headerlink" title="5.2 引入Element"></a>5.2 引入Element</h3><p>引入分 完整引入 和 按需引入 两种模式，按需引入可以缩小项目的体积，这里选择完整引入：</p>
<p><code>main.js</code> 中添加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import ElementUI from &#x27;element-ui&#x27;</span><br><span class="line">import &#x27;element-ui/lib/theme-chalk/index.css&#x27;</span><br><span class="line"></span><br><span class="line">Vue.use(ElementUI)</span><br></pre></td></tr></table></figure>

<h3 id="5-3-优化登录页面"><a href="#5-3-优化登录页面" class="headerlink" title="5.3 优化登录页面"></a>5.3 优化登录页面</h3><p>首先，修改 <code>&lt;template&gt;</code> 里的代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">id</span>=<span class="string">&quot;poster&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">class</span>=<span class="string">&quot;login-container&quot;</span> <span class="attr">label-position</span>=<span class="string">&quot;left&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;0px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;login-title&quot;</span>&gt;</span>系统登录<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;loginForm.username&quot;</span> <span class="attr">auto-complete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;账号&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;loginForm.userPwd&quot;</span> <span class="attr">auto-complete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">placeholer</span>=<span class="string">&quot;密码&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; background: #505458; border: none&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;login&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>大致结构：</p>
<ul>
<li><code>el-form</code><ul>
<li><code>el-form-item</code><ul>
<li><code>el-input</code>    &#x2F;    <code>el-button</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>样式：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.login-container</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">background-clip</span>: padding-box;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">90px</span> auto;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">350px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">35px</span> <span class="number">35px</span> <span class="number">15px</span> <span class="number">35px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eaeaea</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">25px</span> <span class="number">#cac6c6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.login_title</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span> auto <span class="number">40px</span> auto;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#505458</span>;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="selector-id">#poster</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>:<span class="built_in">url</span>(<span class="string">&quot;../assets/eva.jpg&quot;</span>) no-repeat;</span><br><span class="line">  <span class="attribute">background-position</span>: center;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>登录页面开发已经较为完善，但是：</p>
<p>此时可以直接输入首页网址跳过登录界面，为此，需要开发一个<strong>拦截器</strong>。</p>
<h2 id="6-前端路由与拦截器"><a href="#6-前端路由与拦截器" class="headerlink" title="6. 前端路由与拦截器"></a>6. 前端路由与拦截器</h2><h3 id="6-1-前端路由"><a href="#6-1-前端路由" class="headerlink" title="6.1 前端路由"></a>6.1 前端路由</h3><p>之前我们做的页面的 URL 里有一个 # 号，这个 # 号有什么含义呢？</p>
<p>假设在 html 中有这么一段代码：&lt;div id&#x3D;”test”&gt;This is a test&lt;&#x2F;div&gt;，如果我们想让页面定位到这个 div 所在的位置，可以加一个超链接 <a herf="#test">Jump to test</a>，这里的 # 被称为“锚点”，点击超链接，可以发现网页的 URL 发生了变化，但页面并不会跳转。</p>
<p>在互联网流量如此庞大的今天，我们需要想办法后端服务器的压力，利用 AJAX，我们可以不重载页面就刷新数据，如果再加上 <code>#</code> 号的特性（即改变 URL 却不请求后端），我们就可以在前端实现页面的整体变化，而不用每次都去请求后端。</p>
<p>为了实现前端路由，我们可以监听 <code>#</code> 号后面内容的变化（<code>hashChange</code>），从而动态改变页面内容。URL 的 <code>#</code> 号后面的地址被称为 <code>hash</code> ，估计是哪个大神拍脑袋想的，不用深究。这种实现方式我们称之为 <code>Hash</code> 模式，是非常典型的前端路由方式。</p>
<p>另一种常用的方式被称为 History 模式，这种方式使用了 History API，History API 顾名思义就是针对历史记录的 API ，这种模式的原理是先把页面的状态保存到一个对象（state）里，当页面的 URL 变化时找到对应的对象，从而还原这个页面。其实原本人家这个功能是为了方便浏览器前进后退的，不得不说程序员们的脑洞真大。使用了这种模式，就可以摆脱 # 号实现前端路由。</p>
<h3 id="6-2-使用-History-模式"><a href="#6-2-使用-History-模式" class="headerlink" title="6.2 使用 History 模式"></a>6.2 使用 History 模式</h3><p>把 Vue 中配置的路由从默认的 <code>hash</code> 模式切换为 <code>history</code> 模式：</p>
<p><code>router\index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">Login</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/index&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;AppIndex&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">AppIndex</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>接下来，我们把前端打包后部署在后端。这不是前后端分离项目推荐的做法，之前我们讲过其实应该把前后端分别部署在不同的服务器中，但实际上仍有不少项目会选择把前后端整合在一起，只使用一个服务器，所以这里我们也提及一下这种方式，但在之后的开发中不会这样部署。</p>
<p>先在项目目录执行 npm run build，控制台输出如下内容表明执行完毕：</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203181048309.png" alt="image-20220318104815124"></p>
<p>这时在项目的 dist 文件夹下生成了 static 文件夹和 index.html 文件，把这两个文件，拷贝到我们后端项目的 wj\src\main\resources\static 文件夹下，一定要注意这个位置，这是后端配置的静态文件的 path，虽然看起来很诡异，但一般都不作修改。</p>
<p>接下来，打开后端项目并运行，访问 <a target="_blank" rel="noopener" href="http://localhost:8443/index.html">http://localhost:8443/index.html</a> ，（注意输入后缀 .html）发现页面是空白的，但确实取到了这个页面，再访问 <a target="_blank" rel="noopener" href="http://localhost:8443/login">http://localhost:8443/login</a> ,发现跳转到了错误页面（White Error Page）。</p>
<p>这里我们回顾一下单页面应用的概念，在我们这个项目中，其实只有 index.html 这一个页面，所有的其它内容都是在这个页面里动态渲染的。当我们直接在后端访问 &#x2F;login 路径时，服务器会后端并没有这个路径对应的内容，所以返回了 Error Page。</p>
<p>为了获取到我们需要的内容，我们要想办法触发前端路由，即在后端添加处理内容，把 通过这个 URL 渲染出的 index.html 返回到浏览器。</p>
<p>在后端项目中新建一个 package 名为 error，新建实现 ErrorPageRegistrar 接口的类 ErrorConfig，把默认的错误页面设置为 &#x2F;index.html，代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ErrorConfig</span> <span class="keyword">implements</span> <span class="title class_">ErrorPageRegistrar</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerErrorPages</span><span class="params">(ErrorPageRegistry registry)</span> &#123;</span><br><span class="line">        <span class="type">ErrorPage</span> <span class="variable">error404Page</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorPage</span>(HttpStatus.NOT_FOUND, <span class="string">&quot;/index.html&quot;</span>);</span><br><span class="line">        registry.addErrorPages(error404Page);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重新启动项目，访问 <code>http://localhost:8443/login</code> ，成功进入登录页面。</p>
<h3 id="6-3-后端登录拦截器"><a href="#6-3-后端登录拦截器" class="headerlink" title="6.3 后端登录拦截器"></a>6.3 后端登录拦截器</h3><p>为了完善登录功能，我们需要限制未登录状态下对核心功能页面的访问。登录拦截可以由多种方式来实现，我们首先讲解后端拦截器的开发。（注意如果没有把前后端项目整合起来，就没有办法使用这种方式）</p>
<p>一个简单拦截器的逻辑如下：</p>
<p>1.用户访问 URL，检测是否为登录页面，如果是登录页面则不拦截<br>2.如果用户访问的不是登录页面，检测用户是否已登录，如果未登录则跳转到登录页面</p>
<h4 id="6-3-1-LoginController"><a href="#6-3-1-LoginController" class="headerlink" title="6.3.1 LoginController"></a>6.3.1 LoginController</h4><p>首先我们修改 LoginController 的内容。之前我们实现了通过查询数据库验证用户名是否正确，但仅此而已。</p>
<p>为了保存登录状态，我们可以把用户信息存在 Session 对象中（当用户在应用程序的 Web 页之间跳转时，存储在 Session 对象中的变量不会丢失），这样在访问别的页面时，可以通过判断是否存在用户变量来判断用户是否登录。</p>
<p><code>LoginController</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/api/login&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> User requestUser, HttpSession session)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> requestUser.getUsername();</span><br><span class="line">        username = HtmlUtils.htmlEscape(username);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.get(username, requestUser.getPassword());</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == user) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">400</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            session.setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-3-2-LoginInterceptor"><a href="#6-3-2-LoginInterceptor" class="headerlink" title="6.3.2 LoginInterceptor"></a>6.3.2 LoginInterceptor</h4><p>新建 package 名为 interceptor，新建类 LoginInterceptor。</p>
<p>Interceptor 即拦截器，在 Springboot 我们可以直接继承拦截器的接口，然后实现 preHandle 方法。preHandle 方法里的代码会在访问需要拦截的页面时执行。</p>
<p><code>LoginInterceptor.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span>  <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span> <span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> httpServletRequest.getSession();</span><br><span class="line">        String contextPath=session.getServletContext().getContextPath();</span><br><span class="line">        String[] requireAuthPages = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">                <span class="string">&quot;index&quot;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> httpServletRequest.getRequestURI();</span><br><span class="line"></span><br><span class="line">        uri = StringUtils.remove(uri, contextPath+<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">page</span> <span class="operator">=</span> uri;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(begingWith(page, requireAuthPages))&#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(user==<span class="literal">null</span>) &#123;</span><br><span class="line">                httpServletResponse.sendRedirect(<span class="string">&quot;login&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">begingWith</span><span class="params">(String page, String[] requiredAuthPages)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (String requiredAuthPage : requiredAuthPages) &#123;</span><br><span class="line">            <span class="keyword">if</span>(StringUtils.startsWith(page, requiredAuthPage)) &#123;</span><br><span class="line">                result = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>判断 <code>session</code> 中是否存在 <code>user</code> 属性，如果存在就放行，如果不存在就跳转到 <code>login</code> 页面。这里使用了一个路径列表（<code>requireAuthPages</code>），可以在里面写下需要拦截的路径。</p>
<h4 id="6-3-3-WebConfiger"><a href="#6-3-3-WebConfiger" class="headerlink" title="6.3.3 WebConfiger"></a>6.3.3 WebConfiger</h4><p>写完了拦截器，但是它却并不会生效，因为我们还没有把它配置到项目中。</p>
<p>新建 package 名为 <code>config</code>，新建类 <code>MyWebConfigurer</code>，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyWebConfigurer</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> LoginInterceptor <span class="title function_">getLoginIntercepter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LoginInterceptor</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span>&#123;</span><br><span class="line">        registry.addInterceptor(getLoginIntercepter()).addPathPatterns(<span class="string">&quot;/**&quot;</span>).excludePathPatterns(<span class="string">&quot;/index.html&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过这个配置类，我们添加了之前写好的拦截器。这里有一句非常重要的语句，即</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">registry.addInterceptor(getLoginIntercepter()).addPathPatterns(<span class="string">&quot;/**&quot;</span>).excludePathPatterns(<span class="string">&quot;/index.html&quot;</span>);</span><br></pre></td></tr></table></figure>


<p>这条语句的作用是对所有路径应用拦截器，除了 &#x2F;index.html。</p>
<p>之前我们在拦截器 LoginInterceptor 中配置的路径，即 index，触发的时机是在拦截器生效之后。也就是说，我们访问一个 URL，会首先通过 Configurer 判断是否需要拦截，如果需要，才会触发拦截器 LoginInterceptor，根据我们自定义的规则进行再次判断。</p>
<p><code>/index</code> 与 <code>/index.html</code> 是不同的，也就是说 <code>/index</code> 会触发拦截器而 <code>/index.html</code> 不会，但根据拦截器 LoginInterceptor 中我们定义的判断条件，以<code>/index</code> 开头的路径都会被转发，包括 <code>index.html</code>。</p>
<p>因为我们做的是单页面应用，之前通过配置 ErrorPage，实际上访问所有路径都会重定向到 <code>/index.html</code> 。我们直接在浏览器地址栏输入 <code>/index</code> 会触发拦截器，经过拦截器重定向到 <code>/login</code>，然后 <code>/login</code> 再经过 Configurer 的判断，再次触发拦截器，由于不在需要拦截的路径中，所以被放行，页面则重新定向到了 <code>/index.html</code>，如果没有再 Configurer 中取消对 <code>/index.html</code> 的拦截，则会再次触发拦截器，再次重定向到 <code>/login</code>，引发如下错误。</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203190816454.png"></p>
<h4 id="6-3-4-效果测试"><a href="#6-3-4-效果测试" class="headerlink" title="6.3.4 效果测试"></a>6.3.4 效果测试</h4><p>运行后端项目，访问 <code>http://localhost:8443/index</code> ，发现页面自动跳转到了 <code>http://localhost:8443/login</code> ，输入用户名和密码登录，跳转到 <code>http://localhost:8443/index</code> ， 这时可以把浏览器标签关掉，再在一个新标签页输入 <code>http://localhost:8443/index</code> ，发现不会被拦截。</p>
<h3 id="6-4-Vuex-与前端登录拦截器"><a href="#6-4-Vuex-与前端登录拦截器" class="headerlink" title="6.4 Vuex 与前端登录拦截器"></a>6.4 Vuex 与前端登录拦截器</h3><p>前面我们使用了后端拦截器，但这种拦截器只有在将前后端项目整合在一起时才能生效，而前后端分离的项目实际上不推荐这么做，接下来我们尝试用前端实现相似的功能。</p>
<p>实现前端登录器，需要在前端判断用户的登录状态。我们可以像之前那样在组件的 data 中设置一个状态标志，但登录状态应该被视为一个全局属性，而不应该只写在某一组件中。</p>
<p>所以我们需要引入一个新的工具——Vuex，它是<strong>专门为 Vue 开发的状态管理方案</strong>，我们可以把需要在各个组件中传递使用的变量、方法定义在这里。</p>
<h4 id="6-4-1-引入-Vuex-创建一个全局的库，用来装登录完成的用户"><a href="#6-4-1-引入-Vuex-创建一个全局的库，用来装登录完成的用户" class="headerlink" title="6.4.1 引入 Vuex - 创建一个全局的库，用来装登录完成的用户"></a>6.4.1 引入 Vuex - 创建一个全局的库，用来装登录完成的用户</h4><p>项目文件夹中运行 <code>npm install vuex --save</code> ，若因为版本问题报错，运行： <code>npm install vuex@3.6.2 --save</code></p>
<p>在 src 目录下新建一个文件夹 store，并在该目录下新建 index.js 文件，在该文件中引入 vue 和 vuex，代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br></pre></td></tr></table></figure>

<p>之后，我们在 index.js 里设置我们需要的状态变量和方法。为了实现登录拦截器，我们需要一个记录用户信息的变量。为了方便日后的扩展（权限认证等），我们使用一个用户对象而不是仅仅使用一个布尔变量。同时，设置一个方法，触发这个方法时可以为我们的用户对象赋值。完整的代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">user</span>: &#123;</span><br><span class="line">      <span class="attr">username</span>: <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;user&#x27;</span> || <span class="string">&#x27;[]&#x27;</span>) == <span class="literal">null</span> ? <span class="string">&#x27;&#x27;</span> : <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;user&#x27;</span> || <span class="string">&#x27;[]&#x27;</span>)).<span class="property">username</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    login (state, user) &#123;</span><br><span class="line">      state.<span class="property">user</span> = user</span><br><span class="line">      <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;user&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这里我们还用到了 <code>localStorage</code>，即本地存储，在项目打开的时候会判断本地存储中是否有 user 这个对象存在，如果存在就取出来并获得 <code>username</code> 的值，否则则把 <code>username</code> 设置为空。这样我们只要不清除缓存，登录的状态就会一直保存。</p>
<h4 id="6-4-2-修改路由配置-设置需要拦截的路由"><a href="#6-4-2-修改路由配置-设置需要拦截的路由" class="headerlink" title="6.4.2 修改路由配置 - 设置需要拦截的路由"></a>6.4.2 修改路由配置 - 设置需要拦截的路由</h4><p>为了区分页面是否需要拦截，我们需要修改一下 <code>src\router\index.js</code>，在需要拦截的路由中加一条元数据，设置一个 <code>requireAuth</code> 字段如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;/index&#x27;</span>,</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;AppIndex&#x27;</span>,</span><br><span class="line">     <span class="attr">component</span>: <span class="title class_">AppIndex</span>,</span><br><span class="line">     <span class="attr">meta</span>: &#123;</span><br><span class="line">       <span class="attr">requireAuth</span>: <span class="literal">true</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-3-使用钩子函数判断是否拦截-全局设置路由是否拦截"><a href="#6-4-3-使用钩子函数判断是否拦截-全局设置路由是否拦截" class="headerlink" title="6.4.3 使用钩子函数判断是否拦截 - 全局设置路由是否拦截"></a>6.4.3 使用钩子函数判断是否拦截 - 全局设置路由是否拦截</h4><p>钩子函数就是在某些时机会被调用的函数。这里我们使用 <code>router.beforeEach()</code>，意思是在访问每一个路由前调用。</p>
<p>打开 <code>src\main.js</code> ，首先添加对 <code>store</code> 的引用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br></pre></td></tr></table></figure>

<p>并修改 Vue 对象里的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">  el: &#x27;#app&#x27;,</span><br><span class="line">  render: h =&gt; h(App),</span><br><span class="line">  router,</span><br><span class="line">  // 注意这里</span><br><span class="line">  store,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  template: &#x27;&lt;App/&gt;&#x27;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>接着写 <code>beforeEach()</code> 函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">requireAuth</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (store.<span class="property">state</span>.<span class="property">user</span>.<span class="property">username</span>) &#123;</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">next</span>(&#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&#x27;login&#x27;</span>,</span><br><span class="line">          <span class="attr">query</span>: &#123;<span class="attr">redirect</span>: to.<span class="property">fullPath</span>&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>这个的逻辑很简单，首先判断访问的路径是否需要登录，如果需要，判断 <code>store</code> 里有没有存储 <code>user</code> 的信息，如果存在，则放行，否则跳转到登录页面，并存储访问的页面路径（以便在登录后跳转到访问页）。</p>
<h4 id="6-4-4-修改-Login-vue-设置登录成功后将用户加入全局变量"><a href="#6-4-4-修改-Login-vue-设置登录成功后将用户加入全局变量" class="headerlink" title="6.4.4 修改 Login.vue - 设置登录成功后将用户加入全局变量"></a>6.4.4 修改 Login.vue - 设置登录成功后将用户加入全局变量</h4><p>之前的登录组件中，我们只是判断后端返回的状态码，如果是 200，就重定向到首页。在经过前面的配置后，我们需要修改一下登录逻辑，以最终实现登录拦截。</p>
<p>修改后的逻辑如下：</p>
<p>1.点击登录按钮，向后端发送数据<br>2.受到后端返回的成功代码时，触发 store 中的 login() 方法，把 loginForm 对象传递给 store 中的 user 对象<br>（*这里只是简单的实现，在后端我们可以通过用户名和密码查询数据库，获得 user 表的完整信息，比如用户昵称、用户级别等，返回前端，并传递给 user 对象，以实现更复杂的功能）<br>3.获取登录前页面的路径并跳转，如果该路径不存在，则跳转到首页</p>
<p>修改后的 <code>login()</code> 方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">login () &#123;</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="variable language_">this</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>)</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$axios</span></span><br><span class="line">    .<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">username</span>: <span class="variable language_">this</span>.<span class="property">loginForm</span>.<span class="property">username</span>,</span><br><span class="line">      <span class="attr">password</span>: <span class="variable language_">this</span>.<span class="property">loginForm</span>.<span class="property">password</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">successResponse</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (successResponse.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">// var data = this.loginForm</span></span><br><span class="line">        _this.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;login&#x27;</span>, _this.<span class="property">loginForm</span>)</span><br><span class="line">        <span class="keyword">var</span> path = <span class="variable language_">this</span>.<span class="property">$route</span>.<span class="property">query</span>.<span class="property">redirect</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">replace</span>(&#123;<span class="attr">path</span>: path === <span class="string">&#x27;/&#x27;</span> || path === <span class="literal">undefined</span> ? <span class="string">&#x27;/index&#x27;</span> : path&#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">failResponse</span> =&gt;</span> &#123;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-导航栏与图书页面设计"><a href="#7-导航栏与图书页面设计" class="headerlink" title="7. 导航栏与图书页面设计"></a>7. 导航栏与图书页面设计</h2><h3 id="7-1-导航栏的实现"><a href="#7-1-导航栏的实现" class="headerlink" title="7.1 导航栏的实现"></a>7.1 导航栏的实现</h3><p>我们的项目虽然本质上是单页面应用，但表面上有多个功能页面，比如<strong>首页、图书馆、笔记本</strong>等，后期根据情况还可以把一些功能集中起来做一个<strong>后台管理</strong>页面。为了方便用户在这三个页面之间切换，我们需要添加一个导航栏。</p>
<p>这个导航栏的要求很简单：</p>
<ol>
<li>能够在每个页面显示</li>
<li>美观</li>
</ol>
<h4 id="7-1-1-路由配置"><a href="#7-1-1-路由配置" class="headerlink" title="7.1.1 路由配置"></a>7.1.1 路由配置</h4><p>为了实现第一个要求，我们需要把导航栏放在其它页面的父页面中（对 Vue 来说就是父组件），之前我们讲过，App.vue 是所有组件的父组件，但把导航栏放进去不合适，因为我们的登录页面中不应该显示导航栏。</p>
<p>为了解决这个问题，我们在 components 目录下直接新建一个组件，命名为 Home.vue ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;router-view/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;Home&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>这里和 App.vue 一样，写入了一个 <router-view/>，也就是子页面（组件）显示的地方。</p>
<p>接下来，来建立路由的父子关系。注意我们在一个组件中通过导入引用了其它组件，也可以称之为父子组件，但想要通过 <router-view/> 控制子组件的显示，则需要进行路由的相关配置。</p>
<p>打开 <code>router/index.js</code> ，修改代码如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">      <span class="comment">// home页面并不需要被访问</span></span><br><span class="line">      <span class="attr">redirect</span>: <span class="string">&#x27;/index&#x27;</span>,</span><br><span class="line">      <span class="attr">children</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&#x27;/index&#x27;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;AppIndex&#x27;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="title class_">AppIndex</span>,</span><br><span class="line">          <span class="attr">meta</span>: &#123;</span><br><span class="line">            <span class="attr">requireAuth</span>: <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">Login</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>注意我们并没有把首页的访问路径设置为 <code>/home/index</code>，仍然可以通过 <code>/index</code> 访问首页，这样配置其实是感受不到 <code>/home</code> 这个路径的存在的。之后再添加新的页面，可以直接在 <code>children</code> 中增添对应的内容。</p>
<h4 id="7-1-2-使用-NavMenu-组件"><a href="#7-1-2-使用-NavMenu-组件" class="headerlink" title="7.1.2 使用 NavMenu 组件"></a>7.1.2 使用 NavMenu 组件</h4><p>在 <code>components</code> 文件夹里新建一个 <code>common</code> 文件夹，用来存储公共的组件，并在该文件夹新建一个组件 <code>NavMenu.vue</code>，代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-menu</span><br><span class="line">      :default-active=&quot;&#x27;/index&#x27;&quot;</span><br><span class="line">      router</span><br><span class="line">      mode=&quot;horizontal&quot;</span><br><span class="line">      background-color=&quot;white&quot;</span><br><span class="line">      text-color=&quot;#222&quot;</span><br><span class="line">      active-text-color=&quot;red&quot;</span><br><span class="line">      style=&quot;min-width: 1300px&quot;&gt;</span><br><span class="line">      &lt;el-menu-item v-for=&quot;(item,i) in navList&quot; :key=&quot;i&quot; :index=&quot;item.name&quot;&gt;</span><br><span class="line">        &#123;&#123; item.navItem &#125;&#125;</span><br><span class="line">      &lt;/el-menu-item&gt;</span><br><span class="line">      &lt;a href=&quot;#nowhere&quot; style=&quot;color: #222;float: right;padding: 20px;&quot;&gt;更多功能&lt;/a&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot; style=&quot;float:right;font-size: 45px;color: #222;padding-top: 8px&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span style=&quot;position: absolute;padding-top: 20px;right: 43%;font-size: 20px;font-weight: bold&quot;&gt;White Jotter - Your Mind Palace&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;NavMenu&#x27;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        navList: [</span><br><span class="line">          &#123;name: &#x27;/index&#x27;, navItem: &#x27;首页&#x27;&#125;,</span><br><span class="line">          &#123;name: &#x27;/jotter&#x27;, navItem: &#x27;笔记本&#x27;&#125;,</span><br><span class="line">          &#123;name: &#x27;/library&#x27;, navItem: &#x27;图书馆&#x27;&#125;,</span><br><span class="line">          &#123;name: &#x27;/admin&#x27;, navItem: &#x27;个人中心&#x27;&#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  a&#123;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  span &#123;</span><br><span class="line">    pointer-events: none;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>在 <code>&lt;el-menu&gt;</code> 标签中，开启了 <code>router</code> 模式：<ul>
<li>Element 文档中解释如下：是否使用 vue-router 的模式，启用该模式会在激活导航时以 index 作为 path 进行路由跳转</li>
</ul>
</li>
<li>通过 <code>v-for</code> 指令，把 <code>navList</code> 数组渲染为一组 <code>&lt;el-menu-item&gt;</code> 元素，也就是导航栏的内容。</li>
</ul>
<p>接下来把这个组件放在 <code>Home.vue</code> 中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav-menu&gt;&lt;/nav-menu&gt;</span><br><span class="line">    &lt;router-view/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import NavMenu from &#x27;./common/NavMenu&#x27;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;Home&#x27;,</span><br><span class="line">    components: &#123;NavMenu&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-图书管理页面"><a href="#7-2-图书管理页面" class="headerlink" title="7.2 图书管理页面"></a>7.2 图书管理页面</h3><p>这是我们的核心页面，我们先把它设计出来，以后再去实现具体的功能。</p>
<p>页面大概需要以下内容：</p>
<ol>
<li>图书展示区域</li>
<li>分类导航栏</li>
<li>搜索栏</li>
<li>页码</li>
</ol>
<h4 id="7-2-1-LibraryIndex-vue"><a href="#7-2-1-LibraryIndex-vue" class="headerlink" title="7.2.1 LibraryIndex.vue"></a>7.2.1 LibraryIndex.vue</h4><p>在 <code>components</code> 中新建文件夹 <code>library</code>，新建组件 <code>LibraryIndex.vue</code>，作为图书页面的根组件，代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-container&gt;</span><br><span class="line">    &lt;el-aside style=&quot;width: 200px;margin-top: 20px&quot;&gt;</span><br><span class="line">      &lt;switch&gt;&lt;/switch&gt;</span><br><span class="line">      &lt;!--&lt;SideMenu&gt;&lt;/SideMenu&gt;--&gt;</span><br><span class="line">    &lt;/el-aside&gt;</span><br><span class="line">    &lt;el-main&gt;</span><br><span class="line">      &lt;!--&lt;books&gt;&lt;/books&gt;--&gt;</span><br><span class="line">    &lt;/el-main&gt;</span><br><span class="line">  &lt;/el-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;AppLibrary&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>注释掉的部分是接下来需要编写的组件。这里我们使用了 Element 提供的 Container 布局容器，把整个页面分为了侧边栏和主要区域两个部分</p>
<p>接下来我们配置这个页面的路由，修改 <code>router/index.js</code> 代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line">export default new Router(&#123;</span><br><span class="line">  mode: &#x27;history&#x27;,</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#x27;/home&#x27;,</span><br><span class="line">      name: &#x27;Home&#x27;,</span><br><span class="line">      component: Home,</span><br><span class="line">      redirect: &#x27;/index&#x27;,</span><br><span class="line">      children: [</span><br><span class="line">        &#123;</span><br><span class="line">          path: &#x27;/index&#x27;,</span><br><span class="line">          name: &#x27;AppIndex&#x27;,</span><br><span class="line">          component: AppIndex,</span><br><span class="line">          meta: &#123;</span><br><span class="line">            requireAuth: true</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          path: &#x27;/library&#x27;,</span><br><span class="line">          name: &#x27;Library&#x27;,</span><br><span class="line">          component: LibraryIndex,</span><br><span class="line">          meta: &#123;</span><br><span class="line">            requireAuth: true</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#x27;/login&#x27;,</span><br><span class="line">      name: &#x27;Login&#x27;,</span><br><span class="line">      component: Login</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="7-2-2-SideMenu-vue"><a href="#7-2-2-SideMenu-vue" class="headerlink" title="7.2.2 SideMenu.vue"></a>7.2.2 SideMenu.vue</h4><p>编写一个侧边栏组件。放在 <code>/library</code> 文件夹中，代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-menu</span><br><span class="line">    class=&quot;categories&quot;</span><br><span class="line">    default-active=&quot;0&quot;</span><br><span class="line">    @select=&quot;handleSelect&quot;</span><br><span class="line">    active-text-color=&quot;red&quot;&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;0&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;全部&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;1&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;文学&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;2&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;流行&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;3&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;文化&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;4&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;生活&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;5&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;经管&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;6&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;科技&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">  &lt;/el-menu&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;SideMenu&#x27;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      handleOpen (key, keyPath) &#123;</span><br><span class="line">        console.log(key, keyPath)</span><br><span class="line">      &#125;,</span><br><span class="line">      handleClose (key, keyPath) &#123;</span><br><span class="line">        console.log(key, keyPath)</span><br><span class="line">      &#125;,</span><br><span class="line">      handleSelect (key, keyPath) &#123;</span><br><span class="line">        console.log(key, keyPath)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .categories &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    margin-left: 50%;</span><br><span class="line">    left: -600px;</span><br><span class="line">    top: 100px;</span><br><span class="line">    width: 150px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>在 <code>LibraryIndex.vue</code> 中使用这个组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-container&gt;</span><br><span class="line">    &lt;el-aside style=&quot;width: 200px;margin-top: 20px&quot;&gt;</span><br><span class="line">      &lt;switch&gt;&lt;/switch&gt;</span><br><span class="line">      &lt;SideMenu&gt;&lt;/SideMenu&gt;</span><br><span class="line">    &lt;/el-aside&gt;</span><br><span class="line">    &lt;el-main&gt;</span><br><span class="line">      &lt;!--&lt;books&gt;&lt;/books&gt;--&gt;</span><br><span class="line">    &lt;/el-main&gt;</span><br><span class="line">  &lt;/el-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import SideMenu from &#x27;./SideMenu&#x27;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;AppLibrary&#x27;,</span><br><span class="line">    components: &#123;SideMenu&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="7-2-3-Books-vue"><a href="#7-2-3-Books-vue" class="headerlink" title="7.2.3 Books.vue"></a>7.2.3 Books.vue</h4><p>最后，我们用一个组件来显示图书。这个组件比较复杂，初始代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-row style=&quot;height: 840px;&quot;&gt;</span><br><span class="line">      &lt;!--&lt;search-bar&gt;&lt;/search-bar&gt;--&gt;</span><br><span class="line">      &lt;el-tooltip effect=&quot;dark&quot; placement=&quot;right&quot;</span><br><span class="line">                  v-for=&quot;item in books&quot;</span><br><span class="line">                  :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;p slot=&quot;content&quot; style=&quot;font-size: 14px;margin-bottom: 6px;&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p slot=&quot;content&quot; style=&quot;font-size: 13px;margin-bottom: 6px&quot;&gt;</span><br><span class="line">          &lt;span&gt;&#123;&#123;item.author&#125;&#125;&lt;/span&gt; /</span><br><span class="line">          &lt;span&gt;&#123;&#123;item.date&#125;&#125;&lt;/span&gt; /</span><br><span class="line">          &lt;span&gt;&#123;&#123;item.press&#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p slot=&quot;content&quot; style=&quot;width: 300px&quot; class=&quot;abstract&quot;&gt;&#123;&#123;item.abs&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;el-card style=&quot;width: 135px;margin-bottom: 20px;height: 233px;float: left;margin-right: 15px&quot; class=&quot;book&quot;</span><br><span class="line">                 bodyStyle=&quot;padding:10px&quot; shadow=&quot;hover&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;cover&quot;&gt;</span><br><span class="line">            &lt;img :src=&quot;item.cover&quot; alt=&quot;封面&quot;&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;a href=&quot;&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;author&quot;&gt;&#123;&#123;item.author&#125;&#125;&lt;/div&gt;</span><br><span class="line">        &lt;/el-card&gt;</span><br><span class="line">      &lt;/el-tooltip&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">    &lt;el-row&gt;</span><br><span class="line">      &lt;el-pagination</span><br><span class="line">        :current-page=&quot;1&quot;</span><br><span class="line">        :page-size=&quot;10&quot;</span><br><span class="line">        :total=&quot;20&quot;&gt;</span><br><span class="line">      &lt;/el-pagination&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;Books&#x27;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        books: [</span><br><span class="line">          &#123;</span><br><span class="line">            cover: &#x27;https://i.loli.net/2019/04/10/5cada7e73d601.jpg&#x27;,</span><br><span class="line">            title: &#x27;三体&#x27;,</span><br><span class="line">            author: &#x27;刘慈欣&#x27;,</span><br><span class="line">            date: &#x27;2019-05-05&#x27;,</span><br><span class="line">            press: &#x27;重庆出版社&#x27;,</span><br><span class="line">            abs: &#x27;文化大革命如火如荼进行的同时。军方探寻外星文明的绝秘计划“红岸工程”取得了突破性进展。但在按下发射键的那一刻，历经劫难的叶文洁没有意识到，她彻底改变了人类的命运。地球文明向宇宙发出的第一声啼鸣，以太阳为中心，以光速向宇宙深处飞驰……&#x27;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .cover &#123;</span><br><span class="line">    width: 115px;</span><br><span class="line">    height: 172px;</span><br><span class="line">    margin-bottom: 7px;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  img &#123;</span><br><span class="line">    width: 115px;</span><br><span class="line">    height: 172px;</span><br><span class="line">    /*margin: 0 auto;*/</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    text-align: left;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .author &#123;</span><br><span class="line">    color: #333;</span><br><span class="line">    width: 102px;</span><br><span class="line">    font-size: 13px;</span><br><span class="line">    margin-bottom: 6px;</span><br><span class="line">    text-align: left;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .abstract &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    line-height: 17px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  a &#123;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  a:link, a:visited, a:focus &#123;</span><br><span class="line">    color: #3377aa;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<p>之后我们要实现的许多功能都与这个组件有关。目前用到的这部分，需要注意的有：</p>
<ul>
<li>v-for 指令，之后可以使用动态渲染，这里我们用《三体》的内容作为一个默认值，先查看效果。</li>
</ul>
<ul>
<li><p>el-tooltip Element 提供的组件，用于展示鼠标悬停时的提示信息。参考 <a target="_blank" rel="noopener" href="https://element.eleme.cn/2.0/#/zh-CN/component/tooltip">https://element.eleme.cn/2.0/#/zh-CN/component/tooltip</a></p>
</li>
<li><p>slot 插槽，及把标签中的内容插到父组件指定的地方，这里我们插入了 el-tooltip 的 content 中。上述文档中亦有描述。</p>
</li>
<li><p>封面图像标签中，我们使用了 :src&#x3D;”item.cover” 这种写法，: 其实是 v-bind: 的缩写，用于绑定把标签的属性与 data 中的值绑定起来。</p>
</li>
<li><p>搜索栏暂不理会</p>
</li>
<li><p>分页使用 el-pagination 组件，目前只是样式。</p>
</li>
</ul>
<p>最后把 Books 组件放在 <code>LibraryIndex.vue</code> 中，并稍微修改一下样式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-container&gt;</span><br><span class="line">    &lt;el-aside style=&quot;width: 200px;margin-top: 20px&quot;&gt;</span><br><span class="line">      &lt;switch&gt;&lt;/switch&gt;</span><br><span class="line">      &lt;SideMenu&gt;&lt;/SideMenu&gt;</span><br><span class="line">    &lt;/el-aside&gt;</span><br><span class="line">    &lt;el-main&gt;</span><br><span class="line">      &lt;books class=&quot;books-area&quot;&gt;&lt;/books&gt;</span><br><span class="line">    &lt;/el-main&gt;</span><br><span class="line">  &lt;/el-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import SideMenu from &#x27;./SideMenu&#x27;</span><br><span class="line">  import Books from &#x27;./Books&#x27;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;AppLibrary&#x27;,</span><br><span class="line">    components: &#123;SideMenu, Books&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .books-area &#123;</span><br><span class="line">    width: 990px;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    margin-right: auto;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="8-数据库设计与增删改查"><a href="#8-数据库设计与增删改查" class="headerlink" title="8. 数据库设计与增删改查"></a>8. 数据库设计与增删改查</h2><h3 id="8-1-数据库设计"><a href="#8-1-数据库设计" class="headerlink" title="8.1 数据库设计"></a>8.1 数据库设计</h3><p>需求大致如下：</p>
<ul>
<li>展示书籍的信息，包括封面、标题、作者、出版日期、出版社、摘要和分类。</li>
<li>维护分类信息。</li>
</ul>
<p>所以表结构暂时是下面这个样子：</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203181754029.png" alt="在这里插入图片描述"></p>
<h3 id="8-2-增删改查"><a href="#8-2-增删改查" class="headerlink" title="8.2 增删改查"></a>8.2 增删改查</h3><p>先看需求：</p>
<ul>
<li>查询书籍信息（查）</li>
<li>上传书籍信息（增）</li>
<li>修改书籍信息（改）</li>
<li>删除书籍信息（删）</li>
</ul>
<p>查询里涉及按关键字查询（图书检索）</p>
<h4 id="8-2-1-pojo"><a href="#8-2-1-pojo" class="headerlink" title="8.2.1 pojo"></a>8.2.1 pojo</h4><p>新建两个 pojo：Category 和 Book</p>
<p><code>Category</code> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;category&quot;)</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties(&#123; &quot;handler&quot;,&quot;hibernateLazyInitializer&quot; &#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Category</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;id&quot;)</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line"></span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Book</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;book&quot;)</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties(&#123;&quot;handler&quot;,&quot;hibernateLazyInitializer&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;id&quot;)</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne</span></span><br><span class="line">    <span class="meta">@JoinColumn(name=&quot;cid&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Category category;</span><br><span class="line"></span><br><span class="line">    String cover;</span><br><span class="line">    String title;</span><br><span class="line">    String author;</span><br><span class="line">    String date;</span><br><span class="line">    String press;</span><br><span class="line">    String abs;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Category <span class="title function_">getCategory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCategory</span><span class="params">(Category category)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> date;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDate</span><span class="params">(String date)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.date = date;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> press;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPress</span><span class="params">(String press)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.press = press;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAbs</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> abs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAbs</span><span class="params">(String abs)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.abs = abs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCover</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cover;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCover</span><span class="params">(String cover)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cover = cover;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTitle</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTitle</span><span class="params">(String title)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.title = title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAuthor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAuthor</span><span class="params">(String author)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.author = author;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-2-dao层"><a href="#8-2-2-dao层" class="headerlink" title="8.2.2 dao层"></a>8.2.2 dao层</h4><p>添加一个 <code>BookDAO</code>，一个 <code>CategoryDAO</code></p>
<p><code>BookDAO</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDAO</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;Book,Integer&gt; &#123;</span><br><span class="line">    List&lt;Book&gt; <span class="title function_">findAllByCategory</span><span class="params">(Category category)</span>;</span><br><span class="line">    List&lt;Book&gt; <span class="title function_">findAllByTitleLikeOrAuthorLike</span><span class="params">(String keyword1, String keyword2)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里延续之前 JPA 的写法， <code>findAllByCategory()</code> 之所以能实现，是因为在 <code>Book</code> 类中有如下注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ManyToOne</span></span><br><span class="line"><span class="meta">@JoinColumn(name=&quot;cid&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Category category;</span><br></pre></td></tr></table></figure>

<p>实际上是把 <code>category</code> 对象的 id 属性作为 cid 进行了查询</p>
<p><code>CategoryDAO</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.evan.wj.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.evan.wj.pojo.Category;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CategoryDAO</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;Category, Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>CategoryDAO</code> 不需要额外构造的方法， JPA 提供的默认方法就够用了</p>
<h4 id="8-2-3-Service-层"><a href="#8-2-3-Service-层" class="headerlink" title="8.2.3 Service 层"></a>8.2.3 Service 层</h4><p><code>CategoryService</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CategoryService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryDAO categoryDAO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Category&gt; <span class="title function_">list</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Sort</span> <span class="variable">sort</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Sort</span>(Sort.Direction.DESC, <span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> categoryDAO.findAll(sort);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Category <span class="title function_">get</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        Category c= categoryDAO.findById(id).orElse(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>BookService</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    BookDAO bookDAO;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryService categoryService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">list</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Sort</span> <span class="variable">sort</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Sort</span>(Sort.Direction.DESC, <span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bookDAO.findAll(sort);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addOrUpdate</span><span class="params">(Book book)</span> &#123;</span><br><span class="line">        bookDAO.save(book);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        bookDAO.deleteById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listByCategory</span><span class="params">(<span class="type">int</span> cid)</span> &#123;</span><br><span class="line">        <span class="type">Category</span> <span class="variable">category</span> <span class="operator">=</span> categoryService.get(cid);</span><br><span class="line">        <span class="keyword">return</span> bookDAO.findAllByCategory(category);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">Search</span><span class="params">(String keywords)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bookDAO.findAllByTitleLikeOrAuthorLike(<span class="string">&#x27;%&#x27;</span> + keywords + <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;%&#x27;</span> + keywords + <span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里 Service 提供了四个功能，分别是查出所有书籍、增加或更新书籍、通过 id 删除书籍和通过分类查出书籍</p>
<h4 id="8-2-4-Controller-层"><a href="#8-2-4-Controller-层" class="headerlink" title="8.2.4 Controller 层"></a>8.2.4 Controller 层</h4><p><code>LibraryController</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LibraryController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    BookService bookService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/books&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">list</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> bookService.list();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/api/books&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">addOrUpdate</span><span class="params">(<span class="meta">@RequestBody</span> Book book)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        bookService.addOrUpdate(book);</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/api/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> Book book)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        bookService.deleteById(book.getId());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/categories/&#123;cid&#125;/books&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listByCategory</span><span class="params">(<span class="meta">@PathVariable(&quot;cid&quot;)</span> <span class="type">int</span> cid)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> != cid) &#123;</span><br><span class="line">            <span class="keyword">return</span> bookService.listByCategory(cid);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> list();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-5-测试接口"><a href="#8-2-5-测试接口" class="headerlink" title="8.2.5 测试接口"></a>8.2.5 测试接口</h4><p>用 Apipost 测试接口</p>
<h3 id="8-3-后端小总结"><a href="#8-3-后端小总结" class="headerlink" title="8.3 后端小总结"></a>8.3 后端小总结</h3><p>总的来说，感觉 springboot 的后端里：</p>
<ul>
<li>pojo 就是数据库中表在后端对应的实体类；</li>
<li>dao 就是对数据库的操作；通过继承 JpaRepository&lt;T, IdT&gt; 类来完成。其中简单的增删改查都已经自动实现。若有其他操作只需写出方法即可，需要注意的是 DAO 类里面方法的命名要按照 JPA 的规范来命名，就能自动实现；</li>
<li>Service 就是逻辑所在地，不多赘述；</li>
<li>Controller 就是写接口的地方，通过调用 Service 来实现业务，一般不在 Controller 中写过多逻辑代码；</li>
</ul>
<h2 id="9-核心功能的前端实现"><a href="#9-核心功能的前端实现" class="headerlink" title="9. 核心功能的前端实现"></a>9. 核心功能的前端实现</h2><p>增删改查的基本逻辑很简单，就是发送请求调用后端编写好的接口，再根据返回的结果动态渲染页面。由于涉及到了一些概念和技术细节，如 <strong>钩子函数、组件间通信、模糊查询</strong> 等。</p>
<h3 id="9-1-代码部分"><a href="#9-1-代码部分" class="headerlink" title="9.1 代码部分"></a>9.1 代码部分</h3><h4 id="9-1-1-EditForm-vue（新增）"><a href="#9-1-1-EditForm-vue（新增）" class="headerlink" title="9.1.1 EditForm.vue（新增）"></a>9.1.1 EditForm.vue（新增）</h4><p>增加、修改图书的弹出表单。（ library 文件夹下）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;i class=&quot;el-icon-circle-plus-outline&quot;  @click=&quot;dialogFormVisible = true&quot;&gt;&lt;/i&gt;</span><br><span class="line">    &lt;el-dialog</span><br><span class="line">      title=&quot;添加/修改图书&quot;</span><br><span class="line">      :visible.sync=&quot;dialogFormVisible&quot;</span><br><span class="line">      @close=&quot;clear&quot;&gt;</span><br><span class="line">      &lt;el-form v-model=&quot;form&quot; style=&quot;text-align: left&quot; ref=&quot;dataForm&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;书名&quot; :label-width=&quot;formLabelWidth&quot; prop=&quot;title&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;form.title&quot; autocomplete=&quot;off&quot; placeholder=&quot;不加《》&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;作者&quot; :label-width=&quot;formLabelWidth&quot; prop=&quot;author&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;form.author&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;出版日期&quot; :label-width=&quot;formLabelWidth&quot; prop=&quot;date&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;form.date&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;出版社&quot; :label-width=&quot;formLabelWidth&quot; prop=&quot;press&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;form.press&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;封面&quot; :label-width=&quot;formLabelWidth&quot; prop=&quot;cover&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;form.cover&quot; autocomplete=&quot;off&quot; placeholder=&quot;图片 URL&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;简介&quot; :label-width=&quot;formLabelWidth&quot; prop=&quot;abs&quot;&gt;</span><br><span class="line">          &lt;el-input type=&quot;textarea&quot; v-model=&quot;form.abs&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;分类&quot; :label-width=&quot;formLabelWidth&quot; prop=&quot;cid&quot;&gt;</span><br><span class="line">          &lt;el-select v-model=&quot;form.category.id&quot; placeholder=&quot;请选择分类&quot;&gt;</span><br><span class="line">            &lt;el-option label=&quot;文学&quot; value=&quot;1&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;el-option label=&quot;流行&quot; value=&quot;2&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;el-option label=&quot;文化&quot; value=&quot;3&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;el-option label=&quot;生活&quot; value=&quot;4&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;el-option label=&quot;经管&quot; value=&quot;5&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;el-option label=&quot;科技&quot; value=&quot;6&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item prop=&quot;id&quot; style=&quot;height: 0&quot;&gt;</span><br><span class="line">          &lt;el-input type=&quot;hidden&quot; v-model=&quot;form.id&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;onSubmit&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;EditForm&#x27;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        dialogFormVisible: false,</span><br><span class="line">        form: &#123;</span><br><span class="line">          id: &#x27;&#x27;,</span><br><span class="line">          title: &#x27;&#x27;,</span><br><span class="line">          author: &#x27;&#x27;,</span><br><span class="line">          date: &#x27;&#x27;,</span><br><span class="line">          press: &#x27;&#x27;,</span><br><span class="line">          cover: &#x27;&#x27;,</span><br><span class="line">          abs: &#x27;&#x27;,</span><br><span class="line">          category: &#123;</span><br><span class="line">            id: &#x27;&#x27;,</span><br><span class="line">            name: &#x27;&#x27;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        formLabelWidth: &#x27;120px&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      clear () &#123;</span><br><span class="line">        this.form = &#123;</span><br><span class="line">          id: &#x27;&#x27;,</span><br><span class="line">          title: &#x27;&#x27;,</span><br><span class="line">          author: &#x27;&#x27;,</span><br><span class="line">          date: &#x27;&#x27;,</span><br><span class="line">          press: &#x27;&#x27;,</span><br><span class="line">          cover: &#x27;&#x27;,</span><br><span class="line">          abs: &#x27;&#x27;,</span><br><span class="line">          category: &#x27;&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      onSubmit () &#123;</span><br><span class="line">        this.$axios</span><br><span class="line">          .post(&#x27;/books&#x27;, &#123;</span><br><span class="line">            id: this.form.id,</span><br><span class="line">            cover: this.form.cover,</span><br><span class="line">            title: this.form.title,</span><br><span class="line">            author: this.form.author,</span><br><span class="line">            date: this.form.date,</span><br><span class="line">            press: this.form.press,</span><br><span class="line">            abs: this.form.abs,</span><br><span class="line">            category: this.form.category</span><br><span class="line">          &#125;).then(resp =&gt; &#123;</span><br><span class="line">          if (resp &amp;&amp; resp.status === 200) &#123;</span><br><span class="line">            this.dialogFormVisible = false</span><br><span class="line">            this.$emit(&#x27;onSubmit&#x27;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .el-icon-circle-plus-outline &#123;</span><br><span class="line">    margin: 50px 0 0 20px;</span><br><span class="line">    font-size: 100px;</span><br><span class="line">    float: left;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="9-1-2-SearchBar-vue（新增）"><a href="#9-1-2-SearchBar-vue（新增）" class="headerlink" title="9.1.2 SearchBar.vue（新增）"></a>9.1.2 SearchBar.vue（新增）</h4><p>用于搜索的搜索框</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div style=&quot;margin-bottom: 30px;display: flex;justify-content: center;align-items: center&quot;&gt;</span><br><span class="line">    &lt;el-input</span><br><span class="line">      @keyup.enter.native=&quot;searchClick&quot;</span><br><span class="line">      placeholder=&quot;通过书名或作者搜索...&quot;</span><br><span class="line">      prefix-icon=&quot;el-icon-search&quot;</span><br><span class="line">      size=&quot;small&quot;</span><br><span class="line">      style=&quot;width: 400px;margin-right: 10px&quot;</span><br><span class="line">      v-model=&quot;keywords&quot;&gt;</span><br><span class="line">    &lt;/el-input&gt;</span><br><span class="line">    &lt;el-button size=&quot;small&quot; type=&quot;primary&quot; icon=&quot;el-icon-search&quot; @click=&quot;searchClick&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;SearchBar&#x27;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        keywords: &#x27;&#x27;,</span><br><span class="line">        books: [],</span><br><span class="line">        cardLoading: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      searchClick () &#123;</span><br><span class="line">        this.$emit(&#x27;onSearch&#x27;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="9-1-3-Books-vue（修改）"><a href="#9-1-3-Books-vue（修改）" class="headerlink" title="9.1.3 Books.vue（修改）"></a>9.1.3 Books.vue（修改）</h4><p><code>Books.vue</code> 是图书管理页面的核心组件，主要修改如下：</p>
<ul>
<li>添加搜索框</li>
<li>添加增加、删除按钮</li>
<li>完善分页功能</li>
<li>构造增、删、改、查对应的请求</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-row style=&quot;height: 840px;&quot;&gt;</span><br><span class="line">      &lt;search-bar @onSearch=&quot;searchResult&quot; ref=&quot;searchBar&quot;&gt;&lt;/search-bar&gt;</span><br><span class="line">      &lt;el-tooltip effect=&quot;dark&quot; placement=&quot;right&quot;</span><br><span class="line">                  v-for=&quot;item in books.slice((currentPage-1)*pagesize,currentPage*pagesize)&quot;</span><br><span class="line">                  :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;p slot=&quot;content&quot; style=&quot;font-size: 14px;margin-bottom: 6px;&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p slot=&quot;content&quot; style=&quot;font-size: 13px;margin-bottom: 6px&quot;&gt;</span><br><span class="line">          &lt;span&gt;&#123;&#123;item.author&#125;&#125;&lt;/span&gt; /</span><br><span class="line">          &lt;span&gt;&#123;&#123;item.date&#125;&#125;&lt;/span&gt; /</span><br><span class="line">          &lt;span&gt;&#123;&#123;item.press&#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p slot=&quot;content&quot; style=&quot;width: 300px&quot; class=&quot;abstract&quot;&gt;&#123;&#123;item.abs&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;el-card style=&quot;width: 135px;margin-bottom: 20px;height: 233px;float: left;margin-right: 15px&quot; class=&quot;book&quot;</span><br><span class="line">                 bodyStyle=&quot;padding:10px&quot; shadow=&quot;hover&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;cover&quot; @click=&quot;editBook(item)&quot;&gt;</span><br><span class="line">            &lt;img :src=&quot;item.cover&quot; alt=&quot;封面&quot;&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;title&quot;&gt;</span><br><span class="line">              &lt;a href=&quot;&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;i class=&quot;el-icon-delete&quot; @click=&quot;deleteBook(item.id)&quot;&gt;&lt;/i&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;author&quot;&gt;&#123;&#123;item.author&#125;&#125;&lt;/div&gt;</span><br><span class="line">        &lt;/el-card&gt;</span><br><span class="line">      &lt;/el-tooltip&gt;</span><br><span class="line">      &lt;edit-form @onSubmit=&quot;loadBooks()&quot; ref=&quot;edit&quot;&gt;&lt;/edit-form&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">    &lt;el-row&gt;</span><br><span class="line">      &lt;el-pagination</span><br><span class="line">        @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">        :current-page=&quot;currentPage&quot;</span><br><span class="line">        :page-size=&quot;pagesize&quot;</span><br><span class="line">        :total=&quot;books.length&quot;&gt;</span><br><span class="line">      &lt;/el-pagination&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import EditForm from &#x27;./EditForm&#x27;</span><br><span class="line">  import SearchBar from &#x27;./SearchBar&#x27;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;Books&#x27;,</span><br><span class="line">    components: &#123;EditForm, SearchBar&#125;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        books: [],</span><br><span class="line">        currentPage: 1,</span><br><span class="line">        pagesize: 17</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted: function () &#123;</span><br><span class="line">      this.loadBooks()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      loadBooks () &#123;</span><br><span class="line">        var _this = this</span><br><span class="line">        this.$axios.get(&#x27;/books&#x27;).then(resp =&gt; &#123;</span><br><span class="line">          if (resp &amp;&amp; resp.status === 200) &#123;</span><br><span class="line">            _this.books = resp.data</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      handleCurrentChange: function (currentPage) &#123;</span><br><span class="line">        this.currentPage = currentPage</span><br><span class="line">        console.log(this.currentPage)</span><br><span class="line">      &#125;,</span><br><span class="line">      searchResult () &#123;</span><br><span class="line">        var _this = this</span><br><span class="line">        this.$axios</span><br><span class="line">          .get(&#x27;/search?keywords=&#x27; + this.$refs.searchBar.keywords, &#123;</span><br><span class="line">          &#125;).then(resp =&gt; &#123;</span><br><span class="line">          if (resp &amp;&amp; resp.status === 200) &#123;</span><br><span class="line">            _this.books = resp.data</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      deleteBook (id) &#123;</span><br><span class="line">        this.$confirm(&#x27;此操作将永久删除该书籍, 是否继续?&#x27;, &#x27;提示&#x27;, &#123;</span><br><span class="line">          confirmButtonText: &#x27;确定&#x27;,</span><br><span class="line">          cancelButtonText: &#x27;取消&#x27;,</span><br><span class="line">          type: &#x27;warning&#x27;</span><br><span class="line">        &#125;).then(() =&gt; &#123;</span><br><span class="line">            this.$axios</span><br><span class="line">              .post(&#x27;/delete&#x27;, &#123;id: id&#125;).then(resp =&gt; &#123;</span><br><span class="line">              if (resp &amp;&amp; resp.status === 200) &#123;</span><br><span class="line">                this.loadBooks()</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        ).catch(() =&gt; &#123;</span><br><span class="line">          this.$message(&#123;</span><br><span class="line">            type: &#x27;info&#x27;,</span><br><span class="line">            message: &#x27;已取消删除&#x27;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        // alert(id)</span><br><span class="line">      &#125;,</span><br><span class="line">      editBook (item) &#123;</span><br><span class="line">        this.$refs.edit.dialogFormVisible = true</span><br><span class="line">        this.$refs.edit.form = &#123;</span><br><span class="line">          id: item.id,</span><br><span class="line">          cover: item.cover,</span><br><span class="line">          title: item.title,</span><br><span class="line">          author: item.author,</span><br><span class="line">          date: item.date,</span><br><span class="line">          press: item.press,</span><br><span class="line">          abs: item.abs,</span><br><span class="line">          category: &#123;</span><br><span class="line">            id: item.category.id.toString(),</span><br><span class="line">            name: item.category.name</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">  .cover &#123;</span><br><span class="line">    width: 115px;</span><br><span class="line">    height: 172px;</span><br><span class="line">    margin-bottom: 7px;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  img &#123;</span><br><span class="line">    width: 115px;</span><br><span class="line">    height: 172px;</span><br><span class="line">    /*margin: 0 auto;*/</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    text-align: left;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .author &#123;</span><br><span class="line">    color: #333;</span><br><span class="line">    width: 102px;</span><br><span class="line">    font-size: 13px;</span><br><span class="line">    margin-bottom: 6px;</span><br><span class="line">    text-align: left;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .abstract &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    line-height: 17px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .el-icon-delete &#123;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    float: right;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .switch &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 780px;</span><br><span class="line">    top: 25px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  a &#123;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  a:link, a:visited, a:focus &#123;</span><br><span class="line">    color: #3377aa;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="9-1-4-LibraryIndex-vue（修改）"><a href="#9-1-4-LibraryIndex-vue（修改）" class="headerlink" title="9.1.4 LibraryIndex.vue（修改）"></a>9.1.4 LibraryIndex.vue（修改）</h4><p>主要实现了按分类查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-container&gt;</span><br><span class="line">    &lt;el-aside style=&quot;width: 200px;margin-top: 20px&quot;&gt;</span><br><span class="line">      &lt;switch&gt;&lt;/switch&gt;</span><br><span class="line">      &lt;SideMenu @indexSelect=&quot;listByCategory&quot; ref=&quot;sideMenu&quot;&gt;&lt;/SideMenu&gt;</span><br><span class="line">    &lt;/el-aside&gt;</span><br><span class="line">    &lt;el-main&gt;</span><br><span class="line">      &lt;books class=&quot;books-area&quot; ref=&quot;booksArea&quot;&gt;&lt;/books&gt;</span><br><span class="line">    &lt;/el-main&gt;</span><br><span class="line">  &lt;/el-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import SideMenu from &#x27;./SideMenu&#x27;</span><br><span class="line">  import Books from &#x27;./Books&#x27;</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;AppLibrary&#x27;,</span><br><span class="line">    components: &#123;Books, SideMenu&#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      listByCategory () &#123;</span><br><span class="line">        var _this = this</span><br><span class="line">        var cid = this.$refs.sideMenu.cid</span><br><span class="line">        var url = &#x27;categories/&#x27; + cid + &#x27;/books&#x27;</span><br><span class="line">        this.$axios.get(url).then(resp =&gt; &#123;</span><br><span class="line">          if (resp &amp;&amp; resp.status === 200) &#123;</span><br><span class="line">            _this.$refs.booksArea.books = resp.data</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .books-area &#123;</span><br><span class="line">    width: 990px;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    margin-right: auto;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="9-1-5-SideMenu-vue（修改）"><a href="#9-1-5-SideMenu-vue（修改）" class="headerlink" title="9.1.5 SideMenu.vue（修改）"></a>9.1.5 SideMenu.vue（修改）</h4><p>侧边分类导航栏的修改主要是实现了点击分类引发查询事件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-menu</span><br><span class="line">    class=&quot;categories&quot;</span><br><span class="line">    default-active=&quot;0&quot;</span><br><span class="line">    @select=&quot;handleSelect&quot;</span><br><span class="line">    active-text-color=&quot;red&quot;&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;0&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;全部&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;1&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;文学&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;2&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;流行&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;3&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;文化&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;4&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;生活&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;5&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;经管&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">    &lt;el-menu-item index=&quot;6&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-menu&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;span slot=&quot;title&quot;&gt;科技&lt;/span&gt;</span><br><span class="line">    &lt;/el-menu-item&gt;</span><br><span class="line">  &lt;/el-menu&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;SideMenu&#x27;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        cid: &#x27;&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      handleSelect (key, keyPath) &#123;</span><br><span class="line">        this.cid = key</span><br><span class="line">        this.$emit(&#x27;indexSelect&#x27;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .categories &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    margin-left: 50%;</span><br><span class="line">    left: -600px;</span><br><span class="line">    top: 100px;</span><br><span class="line">    width: 150px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<h4 id="9-1-6-测试"><a href="#9-1-6-测试" class="headerlink" title="9.1.6 测试"></a>9.1.6 测试</h4><h3 id="9-2-要点讲解"><a href="#9-2-要点讲解" class="headerlink" title="9.2 要点讲解"></a>9.2 要点讲解</h3><h4 id="9-2-1-查询功能实现"><a href="#9-2-1-查询功能实现" class="headerlink" title="9.2.1 查询功能实现"></a>9.2.1 查询功能实现</h4><p>项目中需要应用查询的地方有以下三处：</p>
<ul>
<li>打开页面，默认查询出所有图书并显示（即页面的初始化）</li>
<li>点击左侧分类栏，按照分类显示图书</li>
<li>在搜索栏中输入作者或书名，可以模糊查询出相关书籍</li>
</ul>
<h5 id="页面的初始化"><a href="#页面的初始化" class="headerlink" title="页面的初始化"></a>页面的初始化</h5><p>在打开页面时触发代码并渲染界面，用到了 Vue 的钩子函数—— mounted；</p>
<p>钩子函数，就是在某个特定条件下被触发的函数。钩子函数由于一般与生命周期对应，所以也有 <strong>“生命周期钩子函数”</strong> 这种叫法，有的地方简称 <strong>“生命周期函数”</strong>。</p>
<p><strong>mounted</strong> 即 <strong>“已挂载”</strong> ，所谓挂载，就是我们写的 Vue 代码被转换为 HTML 并替换相应的 DOM 这个过程，这个过程完事儿的时候，就会执行 mounted 里面的代码，即</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mounted: function () &#123;</span><br><span class="line">  this.loadBooks()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Vue 官方文档对 mounted 的描述：</p>
<p><strong>el 被新创建的 vm.$el 替换，并挂载到实例上去之后调用该钩子</strong></p>
<blockquote>
<p>这句话如何理解？</p>
<p><code>main.js</code> 中的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">  el: &#x27;#app&#x27;,</span><br><span class="line">  router,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  template: &#x27;&lt;App/&gt;&#x27;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>我们 new 的这个 Vue 对象，就是 <code>vm.$el</code> ，而 <code>el</code> ，则是 <code>index.html</code> 里的一个 div。</p>
</blockquote>
</blockquote>
<h5 id="分类显示"><a href="#分类显示" class="headerlink" title="分类显示"></a>分类显示</h5><p>分类这个功能的前端实现逻辑是，点击左侧导航栏，向后端发送一个带有参数的 get 请求，然后同样是修改 <code>data</code> 里的数据以实现动态渲染。核心方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">listByCategory () &#123;</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="variable language_">this</span></span><br><span class="line">  <span class="keyword">var</span> cid = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">sideMenu</span>.<span class="property">cid</span></span><br><span class="line">  <span class="keyword">var</span> url = <span class="string">&#x27;categories/&#x27;</span> + cid + <span class="string">&#x27;/books&#x27;</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$axios</span>.<span class="title function_">get</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">resp</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (resp &amp;&amp; resp.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">      _this.<span class="property">$refs</span>.<span class="property">booksArea</span>.<span class="property">books</span> = resp.<span class="property">data</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方法写在 <code>LibraryIndex.vue</code> 里。</p>
<h6 id="组件之间的通信"><a href="#组件之间的通信" class="headerlink" title="组件之间的通信"></a>组件之间的通信</h6><ul>
<li>使用子组件的data</li>
</ul>
<p>在 LibraryIndex 组件的方法里，我们需要获取 SideMenu组件的 data，如何实现？</p>
<p>可以看出，SideMenu 组件在 LibraryIndex 组件中作为一个 子组件 存在，是 LibraryIndex 组件的一部分。在它的标签中，我们用 ref 属性设置了一个引用名。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">SideMenu</span> @<span class="attr">indexSelect</span>=<span class="string">&quot;listByCategory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sideMenu&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">SideMenu</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>设置子组件事件触发的回调函数</li>
</ul>
<p> @indexSelect&#x3D;”listByCategory”，这个东西为 listByCategory() 方法设置了触发事件。大家熟悉的事件有点击、鼠标移动之类，都有固定的名称，而这个 indexSelect 是我随便起的，为了触发这个事件，在子组件，也即 SideMenu 里有这么个方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handleSelect (key) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">cid</span> = key</span><br><span class="line">  <span class="variable language_">this</span>.$emit(<span class="string">&#x27;indexSelect&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总结一下，当你通过点击选择侧边导航栏的一个标签后，发生了如下的动人的故事：</p>
<p>触发 <code>&lt;el-menu&gt;</code> 组件的 <code>@select</code> 事件，执行 <code>handleSelect</code> 方法<br><code>handleSelect</code> 方法触发 <code>indexSelect</code> 事件，并把 key，即  <code>&lt;el-menu-item&gt;</code>  标签的 <code>index</code> 属性的值赋给 <code>data</code> 中定义的属性，即分类码。<br>父组件收到指令，执行事件对应的方法，即 listByCategory 方法<br>发送请求，后端执行查询代码，返回数据，再通过 refs 修改 Books组件的 data 以动态渲染页面。</p>
<h5 id="搜索栏查询"><a href="#搜索栏查询" class="headerlink" title="搜索栏查询"></a>搜索栏查询</h5><p>核心部分在于 <code>SearchBar</code> ，核心的方法在 <code>Books.vue</code> ，还是**父子组件调用、axios 请求&#96; 的那一套。</p>
<h4 id="9-2-2-增加、修改、删除"><a href="#9-2-2-增加、修改、删除" class="headerlink" title="9.2.2 增加、修改、删除"></a>9.2.2 增加、修改、删除</h4><p>增、删、改，需要向后端发送 Post 请求对数据库进行操作。</p>
<p>发送完请求后有两种选择，一是在接收到后端返回的成功代码后，直接利用前端的数据刷新显示，二是重新执行查询以显示修改后的数据。</p>
<p>前一种做法，如果代码不够严谨，可能出现未能按期望修改数据库却返回成功代码的情况，会造成数据的不一致，这里我们先不采用。</p>
<p>后一种做法又有两种实现方法，一是直接刷新页面，二是执行查询对应的 Ajax 请求，利用双向绑定更新显示。刷新页面太粗暴了，会感觉到明显的卡顿，白白增加了前后端的负担，所以我们还是选第二种方法吧。</p>
<h5 id="增加和修改"><a href="#增加和修改" class="headerlink" title="增加和修改"></a>增加和修改</h5><p>设计是点击圆圆的那个添加按钮，可以新增，点击书籍封面图片，可以修改。增加和修改其实用的是同一个表单，不同的是修改需要先查询出原来的信息，然后对数据库执行更新操作，而增加则是直接执行插入操作。不过由于我们使用了 JPA，一个 <code>save()</code> 方法就搞定了。</p>
<p>这两个功能的核心组件是 <code>EditForm.vue</code>，它由两部分组成，一个是那个加号图标，即</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-circle-plus-outline&quot;</span>  @<span class="attr">click</span>=<span class="string">&quot;dialogFormVisible = true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>一个是 Element 的 dialog 组件 <el-dialog>。我们通过该组件的 :visble.sync 属性控制它的显示，默认是隐藏的，当点击加号时才会显示。</p>
<p>在 EditForm.vue 组件中，我们实现了一个 clear() 方法，目的是在关闭输入框时清空原来的内容。不然如果先修改一本书，又点击添加，表单里的内容会仍旧存在。</p>
<p>核心的方法是 onSubmit，提交数据，并触发父组件中定义的 onSubmit 事件，而这个事件对应的方法则是 loadBooks()，即查询出所有的书籍。</p>
<p>为了实现修改，在 Books.vue 中的书籍封面部分我们也添加了一个点击事件，并传递了书籍的参数：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;editBook(item)&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;item.cover&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;封面&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>editBook</code> 这个方法即负责弹出修改表单并渲染数据：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">editBook (item) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">edit</span>.<span class="property">dialogFormVisible</span> = <span class="literal">true</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">edit</span>.<span class="property">form</span> = &#123;</span><br><span class="line">    <span class="attr">id</span>: item.<span class="property">id</span>,</span><br><span class="line">    <span class="attr">cover</span>: item.<span class="property">cover</span>,</span><br><span class="line">    <span class="attr">title</span>: item.<span class="property">title</span>,</span><br><span class="line">    <span class="attr">author</span>: item.<span class="property">author</span>,</span><br><span class="line">    <span class="attr">date</span>: item.<span class="property">date</span>,</span><br><span class="line">    <span class="attr">press</span>: item.<span class="property">press</span>,</span><br><span class="line">    <span class="attr">abs</span>: item.<span class="property">abs</span>,</span><br><span class="line">    <span class="attr">category</span>: &#123;</span><br><span class="line">      <span class="attr">id</span>: item.<span class="property">category</span>.<span class="property">id</span>.<span class="title function_">toString</span>(),</span><br><span class="line">      <span class="attr">name</span>: item.<span class="property">category</span>.<span class="property">name</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h5><p>删除真是最简单的部分了。先安排一个图标元素的点击事件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-delete&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;deleteBook(item.id)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>核心方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">deleteBook (id) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.$confirm(<span class="string">&#x27;此操作将永久删除该书籍, 是否继续?&#x27;</span>, <span class="string">&#x27;提示&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确定&#x27;</span>,</span><br><span class="line">    <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$axios</span></span><br><span class="line">      .<span class="title function_">post</span>(<span class="string">&#x27;/delete&#x27;</span>, &#123;<span class="attr">id</span>: id&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">resp</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (resp &amp;&amp; resp.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">loadBooks</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">         ).<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.$message(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;已取消删除&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="10-图片上传与项目的打包部署"><a href="#10-图片上传与项目的打包部署" class="headerlink" title="10. 图片上传与项目的打包部署"></a>10. 图片上传与项目的打包部署</h2><h3 id="10-1-图片上传"><a href="#10-1-图片上传" class="headerlink" title="10.1 图片上传"></a>10.1 图片上传</h3><p>上传文件的逻辑很简单：前端向后端发送 post 请求，后端对接收到的数据进行处理（压缩、格式转换、重命名等），并保存到服务器中指定的位置，再把该位置对应的 URL 返回给前端即可。</p>
<h4 id="10-1-1-前端部分"><a href="#10-1-1-前端部分" class="headerlink" title="10.1.1 前端部分"></a>10.1.1 前端部分</h4><p>利用 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=element&spm=1001.2101.3001.7020">element</a> 提供的组件 <code>&lt;el-upload&gt;</code> 可以轻松搞定前端。</p>
<p>为了不让原有组件的代码量太大，新建一个组件，命名为 <code>ImgUpload.vue</code>，对上传组件做了一些简单的配置，代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-upload</span><br><span class="line">    class=&quot;img-upload&quot;</span><br><span class="line">    ref=&quot;upload&quot;</span><br><span class="line">    action=&quot;http://localhost:8443/api/covers&quot;</span><br><span class="line">    :on-preview=&quot;handlePreview&quot;</span><br><span class="line">    :on-remove=&quot;handleRemove&quot;</span><br><span class="line">    :before-remove=&quot;beforeRemove&quot;</span><br><span class="line">    :on-success=&quot;handleSuccess&quot;</span><br><span class="line">    multiple</span><br><span class="line">    :limit=&quot;1&quot;</span><br><span class="line">    :on-exceed=&quot;handleExceed&quot;</span><br><span class="line">    :file-list=&quot;fileList&quot;&gt;</span><br><span class="line">    &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;&gt;点击上传&lt;/el-button&gt;</span><br><span class="line">    &lt;div slot=&quot;tip&quot; class=&quot;el-upload__tip&quot;&gt;只能上传jpg/png文件，且不超过500kb&lt;/div&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;ImgUpload&#x27;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        fileList: [],</span><br><span class="line">        url: &#x27;&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      handleRemove (file, fileList) &#123;</span><br><span class="line">      &#125;,</span><br><span class="line">      handlePreview (file) &#123;</span><br><span class="line">      &#125;,</span><br><span class="line">      handleExceed (files, fileList) &#123;</span><br><span class="line">        this.$message.warning(`当前限制选择 1 个文件，本次选择了 $&#123;files.length&#125; 个文件，共选择了 $&#123;files.length + fileList.length&#125; 个文件`)</span><br><span class="line">      &#125;,</span><br><span class="line">      beforeRemove (file, fileList) &#123;</span><br><span class="line">        return this.$confirm(`确定移除 $&#123;file.name&#125;？`)</span><br><span class="line">      &#125;,</span><br><span class="line">      handleSuccess (response) &#123;</span><br><span class="line">        this.url = response</span><br><span class="line">        this.$emit(&#x27;onUpload&#x27;)</span><br><span class="line">        this.$message.warning(&#x27;上传成功&#x27;)</span><br><span class="line">      &#125;,</span><br><span class="line">      clear () &#123;</span><br><span class="line">        this.$refs.upload.clearFiles()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>可以看出，action 属性指定了上传操作对应的 api。各种事件钩子可以顾名思义。我们主要用了 :before-remove、:on-success、:on-exceed 几种，其它的可以根据需要自行编写。</p>
<p>还有一个重要的属性是 multiple，和 :limit 属性配合使用可以检测上传文件的数量。</p>
<p>根据 :on-success 事件对应的方法，当该组件接收到后端返回的成功信息时，会触发父组件 EditForm.vue 的 onUpload 事件，把接收到的 URL 赋给图书信息表单的 cover 字段，这个 URL 需要我们在后端根据资源存放位置生成。提交后，数据库里就会保存服务器上的资源对应的 URL。</p>
<p><code>EditForm.vue</code> 对应的修改有两处，一是在表单中封面字段的位置添加该组件，即下图的效果：</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182222333.png" alt="在这里插入图片描述"></p>
<p><code>EditForm.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;封面&quot;</span> <span class="attr">:label-width</span>=<span class="string">&quot;formLabelWidth&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cover&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;form.cover&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;图片 URL&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img-upload</span> @<span class="attr">onUpload</span>=<span class="string">&quot;uploadImg&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;imgUpload&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img-upload</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>onUpload 事件的回调函数为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uploadImg () &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">cover</span> = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">imgUpload</span>.<span class="property">url</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-1-2-后端部分"><a href="#10-1-2-后端部分" class="headerlink" title="10.1.2 后端部分"></a>10.1.2 后端部分</h4><p>后端主要解决如下两个问题：</p>
<ul>
<li>如何接收前端传来的图片数据并保存</li>
<li>如何避免重名（图片资源的名字很可能重复，如不修改可能出现问题）</li>
</ul>
<p>首先，在后端新建 <code>utils</code> 包，创建一个工具类 <code>StringUtils</code> 并编写生成指定长度随机字符串的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringUtils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getRandomString</span><span class="params">(<span class="type">int</span> length)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">number</span> <span class="operator">=</span> random.nextInt(base.length());</span><br><span class="line">            sb.append(base.charAt(number));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在 <code>LibraryController</code> 中添加 PostMapping：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;api/covers&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">coversUpload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">folder</span> <span class="operator">=</span> <span class="string">&quot;D:/workspace/img&quot;</span>;</span><br><span class="line">    <span class="type">File</span> <span class="variable">imageFolder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(folder);</span><br><span class="line">    <span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(imageFolder, StringUtils.getRandomString(<span class="number">6</span>) + file.getOriginalFilename()</span><br><span class="line">            .substring(file.getOriginalFilename().length() - <span class="number">4</span>));</span><br><span class="line">    <span class="keyword">if</span> (!f.getParentFile().exists())</span><br><span class="line">        f.getParentFile().mkdirs();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        file.transferTo(f);</span><br><span class="line">        <span class="type">String</span> <span class="variable">imgURL</span> <span class="operator">=</span> <span class="string">&quot;http://localhost:8443/api/file/&quot;</span> + f.getName();</span><br><span class="line">        <span class="keyword">return</span> imgURL;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然，现在这样还不行，这个 URL 的前缀是我们自己构建的，还需要把它跟我们设置的图片资源文件夹，即 <code>D:/workspace/img</code> 对应起来。</p>
<p>在 <code>config\MyWebConfigurer</code> 中添加如下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">	registry.addResourceHandler(<span class="string">&quot;/api/file/**&quot;</span>).addResourceLocations(<span class="string">&quot;file:&quot;</span> + <span class="string">&quot;d:/workspace/img/&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这段代码的作用：将 API：&#x2F;api&#x2F;file&#x2F;** 对应到了本地资源文件夹：file:d:&#x2F;workspace&#x2F;img&#x2F; ，当外部请求 file 的API时，可以拿到本地对应位置的文件</p>
</blockquote>
<h3 id="10-2-部署项目到服务器"><a href="#10-2-部署项目到服务器" class="headerlink" title="10.2 部署项目到服务器"></a>10.2 部署项目到服务器</h3><p>在开发时采用了前后端分离的模式，在部署的时候有两种选择：</p>
<p>选择一： 把前端项目部署在 web 服务器中，把后端项目部署在应用服务器中</p>
<p>选择二： 把前端项目打包，作为后端项目的静态文件，再把后端项目部署在应用服务器中</p>
<p>一般来讲，既然我们前后端分离了，那选择一是自然而然的，前面也说过，使用 web 服务器的好处有如下几点：</p>
<p>可以实现反向代理，提高网站的安全性<br>方便维护，一些小的修改不必同时协调前后端开发人员<br>对静态资源的加载速度更快<br>但考虑到成本、开发团队技术能力等问题，选择二也有其存在的意义。</p>
<p>下面具体讲一下两种选择的操作方法。</p>
<h4 id="10-2-1-选择一"><a href="#10-2-1-选择一" class="headerlink" title="10.2.1 选择一"></a>10.2.1 选择一</h4><p>首先下载 nginx，官方网址如下：</p>
<p><a target="_blank" rel="noopener" href="http://nginx.org/en/download.html">http://nginx.org/en/download.html</a></p>
<p>把它解压到某个位置，比如 D 盘根目录。</p>
<p>打开前端项目，执行 npm run build，等候进程完成。这时，项目的 dist 文件夹下将出现我们打包好的内容。</p>
<p>把它们拷贝进 nginx\html 下（如果该文件夹里有内容，需要把原来的内容删掉）</p>
<p>接着，配置一下服务器的默认端口，打开 nginx\conf\nginx.conf，找到 server 的配置处，把 listen 80 改为 listen 8081，方便测试，注意后面还有配置虚拟主机的地方，是加了注释符号的，不要找错了</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182323772.png" alt="image-20220318232359730"></p>
<p>最后，由于 nginx 无法直接处理 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=vue&spm=1001.2101.3001.7020">vue</a> 的 history 模式路由，通过地址栏输入地址或刷新页面会导致页面无法访问。</p>
<p>这是由于输入地址或刷新操作会向服务器发出请求，但我们这个单页面应用表面上像更改了地址，实际上还是通过 js 来控制页面的变化，nginx 上并不存在与请求所对应的页面，也就无法做出响应。因此，与后端的做法相同，我们需要把这个请求转发到 index.html。</p>
<p>让我们再次打开 nginx.conf 文件，添加一条 location 配置，同时将原来默认的 location 注释掉：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#location / &#123;</span><br><span class="line">#    root   html;</span><br><span class="line">#    index  index.html index.htm;</span><br><span class="line">#&#125;</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">     try_files $uri $uri/ /index.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，为了能够默认打开首页，我们在前端 <code>router\index.js</code> 里添加一条路由：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;index&#x27;</span>,</span><br><span class="line">      <span class="attr">redirect</span>: <span class="string">&#x27;/index&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">AppIndex</span>,</span><br><span class="line">          <span class="attr">meta</span>: &#123;</span><br><span class="line">            <span class="attr">requireAuth</span>: <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>这样在已登录状态下访问 <a target="_blank" rel="noopener" href="http://localhost:8081/">http://localhost:8081/</a> 会跳转到 &#x2F;index，否则会跳转到登录页面。</p>
<p>配置完成后，运行 nginx 根目录下的 nginx.exe 即可，访问 <a target="_blank" rel="noopener" href="http://localhost:8081/">http://localhost:8081/</a> ，发现自动跳转到了登录界面。当然，这时候没有后端的验证，是登录不了的。</p>
<p>接着，部署后端项目，流程基本类似。正常来讲开发 Java Web 应用都是要配置 tomcat 的，只是由于我们使用的 Spring Boot 内置了一个 tomcat，所以省了不少功夫。更牛逼的是，把 Spring Boot 项目打成 jar 包，这个 tomcat 就被内置到了 jar 包里，也就是说你只需要把这个 jar 包放在有 Java 环境的服务器上直接执行，就万事大吉了。</p>
<p>一般来说 Web 项目我们会打包成 war，然鹅前后端分离嘛，Java 项目只是提供接口，跟传统的 Java 服务端程序类似，打成 jar 包更加轻便。</p>
<p>下面说说打包的步骤。</p>
<p>首先打开后端项目的 <code>pom.xml</code> ，修改 <code>\&lt;packaging\&gt;</code> 标签里的 war 为 jar ，除此之外，还可以配置版本号、jar 包名称等。</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182335045.png" alt="image-20220318233514233"></p>
<p>在该文件夹下执行 <code>mvn install</code> 命令（可以利用 IDEA 的终端）</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203190816474.png" alt="image-20220318233542258"></p>
<p>等待程序执行完成，在项目的 target 文件夹下就会出现我们的 jar 包（.jar.original 是上一次打包的备份文件）</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182335345.png" alt="image-20220318233559310"></p>
<p>然后在控制台中到 jar 包对应的目录下执行 <code>java -jar wj-1.0.0.jar</code> （注意名称）即可。</p>
<p>最后测试一下，访问 <a target="_blank" rel="noopener" href="http://localhost:8081/">http://localhost:8081</a> ，发现可以正常登录并使用后端接口了。</p>
<h4 id="10-2-2-选择二"><a href="#10-2-2-选择二" class="headerlink" title="10.2.2 选择二"></a>10.2.2 选择二</h4><p>前端打包的方式是相同的，不同的是需要把前端项目 <code>dist</code> 文件夹中的两个文件 static 和 index.html 拷贝到后端项目的 <code>\src\main\resources\static</code> 目录下。</p>
<p>之后，把后端项目打成 war 包。打包之前，我们需要把内置的 tomcat 排除出去，避免冗余。</p>
<p>排除的方法有两种，第一种是在 <code>spring-boot-starter-web</code> 的依赖里添加一个 <code>&lt;exclusion&gt;</code>，代码如下：</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203182337544.png" alt="image-20220318233736499"></p>
<p>第二种是在 <code>dependencies</code> 中添加 tomcat 相关依赖如下：</p>
<p><img src="https://gitee.com/hreatedotaer/markdown-images/raw/master/202203190816489.png" alt="image-20220318233756331"></p>
<p>这个 <code>provided</code> 的意思是 tomcat 由外部提供，不用打包。</p>
<p>接下来记得把 <code>&lt;packaging&gt;</code> 处的 jar 改为 war 执行打包命令 <code>mvn install</code>，然后 war 包就出现啦。</p>
<p>至于如何部署 war 包我就不多说了，记得把 tomcat 的默认端口修改为 8443（根据前端的转发端口设置）即可。</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Neuf_Soleil/article/details/97619312">https://blog.csdn.net/Neuf_Soleil/article/details/97619312</a></p>

    </div>

    
    
    

    
        <div class="reward-container">
  <div>原创技术分享，您的支持将鼓励我继续创作。</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="HreateHakunari 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="HreateHakunari 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>HreateHakunari
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://hreatehakunari.com/2022/03/19/Vue2-Springboot%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE/" title="Vue2+Springboot练手项目">http://hreatehakunari.com/2022/03/19/Vue2-Springboot练手项目/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Vue/" rel="tag"># Vue</a>
              <a href="/tags/Vue2/" rel="tag"># Vue2</a>
              <a href="/tags/Springboot/" rel="tag"># Springboot</a>
              <a href="/tags/%E9%A1%B9%E7%9B%AE/" rel="tag"># 项目</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/03/16/Vue3%E7%BB%93%E6%9E%84/" rel="prev" title="Vue3结构">
      <i class="fa fa-chevron-left"></i> Vue3结构
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="nav-number">1.</span> <span class="nav-text">1. 创建项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%89%8D%E7%AB%AF%E7%99%BB%E5%BD%95%E7%95%8C%E9%9D%A2%E5%BC%80%E5%8F%91%E5%8F%8A%E5%89%8D%E7%AB%AF%E7%9A%84%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="nav-number">2.</span> <span class="nav-text">2. 前端登录界面开发及前端的反向代理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E8%AE%BE%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 设置反向代理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E9%85%8D%E7%BD%AE%E9%A1%B5%E9%9D%A2%E8%B7%AF%E7%94%B1"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 配置页面路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E8%B7%A8%E5%9F%9F%E6%94%AF%E6%8C%81"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 跨域支持</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%90%8E%E7%AB%AF%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91"><span class="nav-number">3.</span> <span class="nav-text">3. 后端登录功能开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E5%88%9B%E5%BB%BA%E5%AF%B9%E5%BA%94%E7%9A%84-User-%E7%B1%BB%E5%8F%8A%E4%BC%A0%E5%9B%9EAPI%E6%B6%88%E6%81%AF%E7%9A%84-Result-%E7%B1%BB"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 创建对应的 User 类及传回API消息的 Result 类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E5%88%9B%E5%BB%BALoginController"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 创建LoginController</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%E4%BF%AE%E6%94%B9%E5%90%8E%E7%AB%AF%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E7%AB%AF%E5%8F%A3%EF%BC%9A8443"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 修改后端程序执行端口：8443</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%BC%95%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.</span> <span class="nav-text">4. 引入数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AA%8C%E8%AF%81%E7%99%BB%E5%BD%95"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 使用数据库验证登录</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-1-%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="nav-number">4.1.1.</span> <span class="nav-text">4.1.1 项目相关配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-2-%E7%99%BB%E5%BD%95%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-number">4.1.2.</span> <span class="nav-text">4.1.2 登录控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%8C%E5%96%84-User-%E7%B1%BB"><span class="nav-number">4.1.2.1.</span> <span class="nav-text">完善 User 类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#UserDAO"><span class="nav-number">4.1.2.2.</span> <span class="nav-text">UserDAO</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#UserService"><span class="nav-number">4.1.2.3.</span> <span class="nav-text">UserService</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#LoginController"><span class="nav-number">4.1.2.4.</span> <span class="nav-text">LoginController</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E4%BD%BF%E7%94%A8-Element-ui"><span class="nav-number">5.</span> <span class="nav-text">5. 使用 Element-ui</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E5%AE%89%E8%A3%85"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E5%BC%95%E5%85%A5Element"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 引入Element</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-%E4%BC%98%E5%8C%96%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 优化登录页面</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E4%B8%8E%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">6.</span> <span class="nav-text">6. 前端路由与拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 前端路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-%E4%BD%BF%E7%94%A8-History-%E6%A8%A1%E5%BC%8F"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 使用 History 模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-%E5%90%8E%E7%AB%AF%E7%99%BB%E5%BD%95%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">6.3.</span> <span class="nav-text">6.3 后端登录拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-1-LoginController"><span class="nav-number">6.3.1.</span> <span class="nav-text">6.3.1 LoginController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-2-LoginInterceptor"><span class="nav-number">6.3.2.</span> <span class="nav-text">6.3.2 LoginInterceptor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-3-WebConfiger"><span class="nav-number">6.3.3.</span> <span class="nav-text">6.3.3 WebConfiger</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-4-%E6%95%88%E6%9E%9C%E6%B5%8B%E8%AF%95"><span class="nav-number">6.3.4.</span> <span class="nav-text">6.3.4 效果测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-Vuex-%E4%B8%8E%E5%89%8D%E7%AB%AF%E7%99%BB%E5%BD%95%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">6.4.</span> <span class="nav-text">6.4 Vuex 与前端登录拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-4-1-%E5%BC%95%E5%85%A5-Vuex-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%85%A8%E5%B1%80%E7%9A%84%E5%BA%93%EF%BC%8C%E7%94%A8%E6%9D%A5%E8%A3%85%E7%99%BB%E5%BD%95%E5%AE%8C%E6%88%90%E7%9A%84%E7%94%A8%E6%88%B7"><span class="nav-number">6.4.1.</span> <span class="nav-text">6.4.1 引入 Vuex - 创建一个全局的库，用来装登录完成的用户</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-4-2-%E4%BF%AE%E6%94%B9%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE-%E8%AE%BE%E7%BD%AE%E9%9C%80%E8%A6%81%E6%8B%A6%E6%88%AA%E7%9A%84%E8%B7%AF%E7%94%B1"><span class="nav-number">6.4.2.</span> <span class="nav-text">6.4.2 修改路由配置 - 设置需要拦截的路由</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-4-3-%E4%BD%BF%E7%94%A8%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%8B%A6%E6%88%AA-%E5%85%A8%E5%B1%80%E8%AE%BE%E7%BD%AE%E8%B7%AF%E7%94%B1%E6%98%AF%E5%90%A6%E6%8B%A6%E6%88%AA"><span class="nav-number">6.4.3.</span> <span class="nav-text">6.4.3 使用钩子函数判断是否拦截 - 全局设置路由是否拦截</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-4-4-%E4%BF%AE%E6%94%B9-Login-vue-%E8%AE%BE%E7%BD%AE%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F%E5%90%8E%E5%B0%86%E7%94%A8%E6%88%B7%E5%8A%A0%E5%85%A5%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="nav-number">6.4.4.</span> <span class="nav-text">6.4.4 修改 Login.vue - 设置登录成功后将用户加入全局变量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E5%AF%BC%E8%88%AA%E6%A0%8F%E4%B8%8E%E5%9B%BE%E4%B9%A6%E9%A1%B5%E9%9D%A2%E8%AE%BE%E8%AE%A1"><span class="nav-number">7.</span> <span class="nav-text">7. 导航栏与图书页面设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-%E5%AF%BC%E8%88%AA%E6%A0%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">7.1.</span> <span class="nav-text">7.1 导航栏的实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-1-%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="nav-number">7.1.1.</span> <span class="nav-text">7.1.1 路由配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-2-%E4%BD%BF%E7%94%A8-NavMenu-%E7%BB%84%E4%BB%B6"><span class="nav-number">7.1.2.</span> <span class="nav-text">7.1.2 使用 NavMenu 组件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2"><span class="nav-number">7.2.</span> <span class="nav-text">7.2 图书管理页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-1-LibraryIndex-vue"><span class="nav-number">7.2.1.</span> <span class="nav-text">7.2.1 LibraryIndex.vue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-2-SideMenu-vue"><span class="nav-number">7.2.2.</span> <span class="nav-text">7.2.2 SideMenu.vue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-3-Books-vue"><span class="nav-number">7.2.3.</span> <span class="nav-text">7.2.3 Books.vue</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="nav-number">8.</span> <span class="nav-text">8. 数据库设计与增删改查</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="nav-number">8.1.</span> <span class="nav-text">8.1 数据库设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="nav-number">8.2.</span> <span class="nav-text">8.2 增删改查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-1-pojo"><span class="nav-number">8.2.1.</span> <span class="nav-text">8.2.1 pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-2-dao%E5%B1%82"><span class="nav-number">8.2.2.</span> <span class="nav-text">8.2.2 dao层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-3-Service-%E5%B1%82"><span class="nav-number">8.2.3.</span> <span class="nav-text">8.2.3 Service 层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-4-Controller-%E5%B1%82"><span class="nav-number">8.2.4.</span> <span class="nav-text">8.2.4 Controller 层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-5-%E6%B5%8B%E8%AF%95%E6%8E%A5%E5%8F%A3"><span class="nav-number">8.2.5.</span> <span class="nav-text">8.2.5 测试接口</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-%E5%90%8E%E7%AB%AF%E5%B0%8F%E6%80%BB%E7%BB%93"><span class="nav-number">8.3.</span> <span class="nav-text">8.3 后端小总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E7%9A%84%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0"><span class="nav-number">9.</span> <span class="nav-text">9. 核心功能的前端实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-%E4%BB%A3%E7%A0%81%E9%83%A8%E5%88%86"><span class="nav-number">9.1.</span> <span class="nav-text">9.1 代码部分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-1-EditForm-vue%EF%BC%88%E6%96%B0%E5%A2%9E%EF%BC%89"><span class="nav-number">9.1.1.</span> <span class="nav-text">9.1.1 EditForm.vue（新增）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-2-SearchBar-vue%EF%BC%88%E6%96%B0%E5%A2%9E%EF%BC%89"><span class="nav-number">9.1.2.</span> <span class="nav-text">9.1.2 SearchBar.vue（新增）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-3-Books-vue%EF%BC%88%E4%BF%AE%E6%94%B9%EF%BC%89"><span class="nav-number">9.1.3.</span> <span class="nav-text">9.1.3 Books.vue（修改）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-4-LibraryIndex-vue%EF%BC%88%E4%BF%AE%E6%94%B9%EF%BC%89"><span class="nav-number">9.1.4.</span> <span class="nav-text">9.1.4 LibraryIndex.vue（修改）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-5-SideMenu-vue%EF%BC%88%E4%BF%AE%E6%94%B9%EF%BC%89"><span class="nav-number">9.1.5.</span> <span class="nav-text">9.1.5 SideMenu.vue（修改）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-6-%E6%B5%8B%E8%AF%95"><span class="nav-number">9.1.6.</span> <span class="nav-text">9.1.6 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-%E8%A6%81%E7%82%B9%E8%AE%B2%E8%A7%A3"><span class="nav-number">9.2.</span> <span class="nav-text">9.2 要点讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-1-%E6%9F%A5%E8%AF%A2%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="nav-number">9.2.1.</span> <span class="nav-text">9.2.1 查询功能实现</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">9.2.1.1.</span> <span class="nav-text">页面的初始化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E6%98%BE%E7%A4%BA"><span class="nav-number">9.2.1.2.</span> <span class="nav-text">分类显示</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-number">9.2.1.2.1.</span> <span class="nav-text">组件之间的通信</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E6%A0%8F%E6%9F%A5%E8%AF%A2"><span class="nav-number">9.2.1.3.</span> <span class="nav-text">搜索栏查询</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-2-%E5%A2%9E%E5%8A%A0%E3%80%81%E4%BF%AE%E6%94%B9%E3%80%81%E5%88%A0%E9%99%A4"><span class="nav-number">9.2.2.</span> <span class="nav-text">9.2.2 增加、修改、删除</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0%E5%92%8C%E4%BF%AE%E6%94%B9"><span class="nav-number">9.2.2.1.</span> <span class="nav-text">增加和修改</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4"><span class="nav-number">9.2.2.2.</span> <span class="nav-text">删除</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E4%B8%8E%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%89%93%E5%8C%85%E9%83%A8%E7%BD%B2"><span class="nav-number">10.</span> <span class="nav-text">10. 图片上传与项目的打包部署</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#10-1-%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0"><span class="nav-number">10.1.</span> <span class="nav-text">10.1 图片上传</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#10-1-1-%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-number">10.1.1.</span> <span class="nav-text">10.1.1 前端部分</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-1-2-%E5%90%8E%E7%AB%AF%E9%83%A8%E5%88%86"><span class="nav-number">10.1.2.</span> <span class="nav-text">10.1.2 后端部分</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-2-%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">10.2.</span> <span class="nav-text">10.2 部署项目到服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#10-2-1-%E9%80%89%E6%8B%A9%E4%B8%80"><span class="nav-number">10.2.1.</span> <span class="nav-text">10.2.1 选择一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-2-2-%E9%80%89%E6%8B%A9%E4%BA%8C"><span class="nav-number">10.2.2.</span> <span class="nav-text">10.2.2 选择二</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="HreateHakunari"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">HreateHakunari</p>
  <div class="site-description" itemprop="description">Do not go gentle into that good night.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Hakunari" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Hakunari" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hreatehakunari@gmail.com" title="E-Mail → mailto:hreatehakunari@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://gitee.com/hreatedotaer" title="Gitee → https:&#x2F;&#x2F;gitee.com&#x2F;hreatedotaer" rel="noopener" target="_blank"><i class="fa fa-git fa-fw"></i>Gitee</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://baidu.com/" title="https:&#x2F;&#x2F;baidu.com" rel="noopener" target="_blank">百度</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022-03 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">HreateHakunari</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共36.2k字</span>
</div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>
<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 0;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});
</script> 


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"1sd3IDkAv4xP0V34tN0y6hVm-gzGzoHsz","app_key":"pSTHETKVcicByBJnAH4IB7vQ","server_url":null,"security":true};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  
  <script color='255,255,255' opacity='1.5' zIndex='-1' count='300' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '1sd3IDkAv4xP0V34tN0y6hVm-gzGzoHsz',
      appKey     : 'pSTHETKVcicByBJnAH4IB7vQ',
      placeholder: "欢迎发言~",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-CN' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
